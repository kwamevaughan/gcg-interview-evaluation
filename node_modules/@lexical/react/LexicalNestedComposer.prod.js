/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

"use strict";var e=require("@lexical/react/LexicalCollaborationContext"),t=require("@lexical/react/LexicalComposerContext"),r=require("react"),o=require("react/jsx-runtime");function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var s=n((function(e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(let e=1;e<arguments.length;e++)r.append("v",arguments[e]);throw t.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));function l(e){const t=e.transform();return null!==t?new Set([t]):new Set}exports.LexicalNestedComposer=function({initialEditor:n,children:i,initialNodes:a,initialTheme:c,skipCollabChecks:u}){const p=r.useRef(!1),d=r.useContext(t.LexicalComposerContext);null==d&&s(9);const[f,{getTheme:x}]=d,h=r.useMemo((()=>{const e=c||x()||void 0,r=t.createLexicalComposerContext(d,e);if(void 0!==e&&(n._config.theme=e),n._parentEditor=f,a)for(let e of a){let t=null,r=null;if("function"!=typeof e){const o=e;e=o.replace,t=o.with,r=o.withKlass||null}const o=n._nodes.get(e.getType());n._nodes.set(e.getType(),{exportDOM:o?o.exportDOM:void 0,klass:e,replace:t,replaceWithKlass:r,transforms:l(e)})}else{const e=n._nodes=new Map(f._nodes);for(const[t,r]of e)n._nodes.set(t,{exportDOM:r.exportDOM,klass:r.klass,replace:r.replace,replaceWithKlass:r.replaceWithKlass,transforms:l(r.klass)})}return n._config.namespace=f._config.namespace,n._editable=f._editable,[n,r]}),[]),{isCollabActive:m,yjsDocMap:C}=e.useCollaborationContext(),g=u||p.current||C.has(n.getKey());return r.useEffect((()=>{g&&(p.current=!0)}),[g]),r.useEffect((()=>f.registerEditableListener((e=>{n.setEditable(e)}))),[n,f]),o.jsx(t.LexicalComposerContext.Provider,{value:h,children:!m||g?i:null})};
