/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t=e((function(e){const t=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(let e=1;e<arguments.length;e++)n.append("v",arguments[e]);throw t.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const n="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,r=n&&"documentMode"in document?document.documentMode:null,i=n&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),s=n&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),o=!(!n||!("InputEvent"in window)||r)&&"getTargetRanges"in new window.InputEvent("input"),l=n&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),c=n&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,a=n&&/Android/.test(navigator.userAgent),u=n&&/^(?=.*Chrome).*/i.test(navigator.userAgent),f=n&&a&&u,d=n&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!u;function h(...e){const t=[];for(const n of e)if(n&&"string"==typeof n)for(const[e]of n.matchAll(/\S+/g))t.push(e);return t}const g=1,_=3,p=9,m=11,y=0,x=1,C=2,S=0,T=1,v=2,N=4,b=8,k=128,E=1792|(112|(3|N|b)|k),O=1,w=2,M=3,A=4,D=5,P=6,I=l||c||d?" ":"​",L="\n\n",F=s?" ":I,R="֑-߿יִ-﷽ﹰ-ﻼ",B="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",z=new RegExp("^[^"+B+"]*["+R+"]"),W=new RegExp("^[^"+R+"]*["+B+"]"),$={bold:1,capitalize:1024,code:16,highlight:k,italic:2,lowercase:256,strikethrough:N,subscript:32,superscript:64,underline:b,uppercase:512},K={directionless:1,unmergeable:2},U={center:w,end:P,justify:A,left:O,right:M,start:D},J={[w]:"center",[P]:"end",[A]:"justify",[O]:"left",[M]:"right",[D]:"start"},j={normal:0,segmented:2,token:1},H={[S]:"normal",[v]:"segmented",[T]:"token"};function Y(e,t,n,r,i,s){let o=e.getFirstChild();for(;null!==o;){const e=o.__key;o.__parent===t&&(Kr(o)&&Y(o,e,n,r,i,s),n.has(e)||s.delete(e),i.push(e)),o=o.getNextSibling()}}const V=100;let G=!1,q=0;function X(e){q=e.timeStamp}function Q(e,t,n){const r="BR"===e.nodeName,i=t.__lexicalLineBreak;return i&&(e===i||r&&e.previousSibling===i)||r&&void 0!==vi(e,n)}function Z(e,t,n){const r=gs(ss(n));let i=null,s=null;null!==r&&r.anchorNode===e&&(i=r.anchorOffset,s=r.focusOffset);const o=e.nodeValue;null!==o&&Ri(t,o,i,s,!1)}function ee(e,t,n){if(Jn(e)){const t=e.anchor.getNode();if(t.is(n)&&e.format!==t.getFormat())return!1}return di(t)&&n.isAttached()}function te(e,t,n,r){for(let i=e;i&&!Os(i);i=Zi(i)){const e=vi(i,t);if(void 0!==e){const t=Si(e,n);if(t)return jr(t)||!ps(i)?void 0:[i,t]}else if(i===r)return[r,Oi(n)]}}function ne(e,t,n){G=!0;const r=performance.now()-q>V;try{Br(e,(()=>{const i=or()||function(e){return e.getEditorState().read((()=>{const e=or();return null!==e?e.clone():null}))}(e),o=new Map,l=e.getRootElement(),c=e._editorState,a=e._blockCursorElement;let u=!1,f="";for(let n=0;n<t.length;n++){const d=t[n],h=d.type,g=d.target,_=te(g,e,c,l);if(!_)continue;const[p,m]=_;if("characterData"===h)r&&In(m)&&di(g)&&ee(i,g,m)&&Z(g,m,e);else if("childList"===h){u=!0;const t=d.addedNodes;for(let n=0;n<t.length;n++){const r=t[n],i=Ti(r),o=r.parentNode;if(null!=o&&r!==a&&null===i&&!Q(r,o,e)){if(s){const e=(ps(r)?r.innerText:null)||r.nodeValue;e&&(f+=e)}o.removeChild(r)}}const n=d.removedNodes,r=n.length;if(r>0){let t=0;for(let i=0;i<r;i++){const r=n[i];(Q(r,g,e)||a===r)&&(g.appendChild(r),t++)}r!==t&&o.set(p,m)}}}if(o.size>0)for(const[t,n]of o)n.reconcileObservedMutation(t,e);const d=n.takeRecords();if(d.length>0){for(let t=0;t<d.length;t++){const n=d[t],r=n.addedNodes,i=n.target;for(let t=0;t<r.length;t++){const n=r[t],s=n.parentNode;null==s||"BR"!==n.nodeName||Q(n,i,e)||s.removeChild(n)}}n.takeRecords()}null!==i&&(u&&wi(i),s&&Gi(e)&&i.insertRawText(f))}))}finally{G=!1}}function re(e){const t=e._observer;if(null!==t){ne(e,t.takeRecords(),t)}}function ie(e){!function(e){0===q&&ss(e).addEventListener("textInput",X,!0)}(e),e._observer=new MutationObserver(((t,n)=>{ne(e,t,n)}))}function se(e,t){const n=e.__mode,r=e.__format,i=e.__style,s=t.__mode,o=t.__format,l=t.__style;return!(null!==n&&n!==s||null!==r&&r!==o||null!==i&&i!==l)}function oe(e,t){const n=e.mergeWithSibling(t),r=br()._normalizedNodes;return r.add(e.__key),r.add(t.__key),n}function le(e){let t,n,r=e;if(""!==r.__text||!r.isSimpleText()||r.isUnmergeable()){for(;null!==(t=r.getPreviousSibling())&&In(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(""!==t.__text){if(se(t,r)){r=oe(t,r);break}break}t.remove()}for(;null!==(n=r.getNextSibling())&&In(n)&&n.isSimpleText()&&!n.isUnmergeable();){if(""!==n.__text){if(se(r,n)){r=oe(r,n);break}break}n.remove()}}else r.remove()}function ce(e){return ae(e.anchor),ae(e.focus),e}function ae(e){for(;"element"===e.type;){const t=e.getNode(),n=e.offset;let r,i;if(n===t.getChildrenSize()?(r=t.getChildAtIndex(n-1),i=!0):(r=t.getChildAtIndex(n),i=!1),In(r)){e.set(r.__key,i?r.getTextContentSize():0,"text",!0);break}if(!Kr(r))break;e.set(r.__key,i?r.getChildrenSize():0,"element",!0)}}let ue,fe,de,he,ge,_e,pe,me,ye,xe,Ce="",Se="",Te=null,ve="",Ne="",be=!1,ke=!1,Ee=null;function Oe(e,t){const n=pe.get(e);if(null!==t){const n=je(e);n.parentNode===t&&t.removeChild(n)}if(me.has(e)||fe._keyToDOMMap.delete(e),Kr(n)){const e=We(n,pe);we(e,0,e.length-1,null)}void 0!==n&&Hi(xe,de,he,n,"destroyed")}function we(e,t,n,r){let i=t;for(;i<=n;++i){const t=e[i];void 0!==t&&Oe(t,r)}}function Me(e,t){e.setProperty("text-align",t)}const Ae="40px";function De(e,t){const n=ue.theme.indent;if("string"==typeof n){const r=e.classList.contains(n);t>0&&!r?e.classList.add(n):t<1&&r&&e.classList.remove(n)}const r=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||Ae;e.style.setProperty("padding-inline-start",0===t?"":`calc(${t} * ${r})`)}function Pe(e,t){const n=e.style;0===t?Me(n,""):t===O?Me(n,"left"):t===w?Me(n,"center"):t===M?Me(n,"right"):t===A?Me(n,"justify"):t===D?Me(n,"start"):t===P&&Me(n,"end")}function Ie(e,n){const r=me.get(e);void 0===r&&t(60);const i=r.createDOM(ue,fe);if(function(e,t,n){const r=n._keyToDOMMap;(function(e,t,n){const r=`__lexicalKey_${t._key}`;e[r]=n})(t,n,e),r.set(e,t)}(e,i,fe),In(r)?i.setAttribute("data-lexical-text","true"):jr(r)&&i.setAttribute("data-lexical-decorator","true"),Kr(r)){const e=r.__indent,t=r.__size;if(0!==e&&De(i,e),0!==t){const e=t-1;!function(e,t,n,r){const i=Se;Se="",Le(e,n,0,t,n.getDOMSlot(r)),Be(n,r),Se=i}(We(r,me),e,r,i)}const n=r.__format;0!==n&&Pe(i,n),r.isInline()||Re(null,r,i),Xi(r)&&(Ce+=L,Ne+=L)}else{const t=r.getTextContent();if(jr(r)){const t=r.decorate(fe,ue);null!==t&&Ke(e,t),i.contentEditable="false"}else In(r)&&(r.isDirectionless()||(Se+=t));Ce+=t,Ne+=t}return null!==n&&n.insertChild(i),Hi(xe,de,he,r,"created"),i}function Le(e,t,n,r,i){const s=Ce;Ce="";let o=n;for(;o<=r;++o){Ie(e[o],i);const t=me.get(e[o]);null!==t&&In(t)&&(null===Te&&(Te=t.getFormat()),""===ve&&(ve=t.getStyle()))}Xi(t)&&(Ce+=L);i.element.__lexicalTextContent=Ce,Ce=s+Ce}function Fe(e,t){if(e){const n=e.__last;if(n){const e=t.get(n);if(e)return pn(e)?"line-break":jr(e)&&e.isInline()?"decorator":null}return"empty"}return null}function Re(e,t,n){const r=Fe(e,pe),i=Fe(t,me);r!==i&&t.getDOMSlot(n).setManagedLineBreak(i)}function Be(e,t){const n=t.__lexicalDirTextContent||"",r=t.__lexicalDir||"";if(n!==Se||r!==Ee){const n=""===Se,i=n?Ee:function(e){if(z.test(e))return"rtl";if(W.test(e))return"ltr";return null}(Se);if(i!==r){const s=t.classList,o=ue.theme;let l=null!==r?o[r]:void 0,c=null!==i?o[i]:void 0;if(void 0!==l){if("string"==typeof l){const e=h(l);l=o[r]=e}s.remove(...l)}if(null===i||n&&"ltr"===i)t.removeAttribute("dir");else{if(void 0!==c){if("string"==typeof c){const e=h(c);c=o[i]=e}void 0!==c&&s.add(...c)}t.dir=i}if(!ke){e.getWritable().__dir=i}}Ee=i,t.__lexicalDirTextContent=Se,t.__lexicalDir=i}}function ze(e,n,r){const i=Se;var s;Se="",Te=null,ve="",function(e,n,r){const i=Ce,s=e.__size,o=n.__size;Ce="";const l=r.element;if(1===s&&1===o){const t=e.__first,r=n.__first;if(t===r)$e(t,l);else{const e=je(t),n=Ie(r,null);try{l.replaceChild(n,e)}catch(i){if("object"==typeof i&&null!=i){const s=`${i.toString()} Parent: ${l.tagName}, new child: {tag: ${n.tagName} key: ${r}}, old child: {tag: ${e.tagName}, key: ${t}}.`;throw new Error(s)}throw i}Oe(t,null)}const i=me.get(r);In(i)&&(null===Te&&(Te=i.getFormat()),""===ve&&(ve=i.getStyle()))}else{const i=We(e,pe),c=We(n,me);if(i.length!==s&&t(227),c.length!==o&&t(228),0===s)0!==o&&Le(c,n,0,o-1,r);else if(0===o){if(0!==s){const e=null==r.after&&null==r.before&&null==r.element.__lexicalLineBreak;we(i,0,s-1,e?null:l),e&&(l.textContent="")}}else!function(e,t,n,r,i,s){const o=r-1,l=i-1;let c,a,u=s.getFirstChild(),f=0,d=0;for(;f<=o&&d<=l;){const e=t[f],r=n[d];if(e===r)u=Ue($e(r,s.element)),f++,d++;else{void 0===c&&(c=new Set(t)),void 0===a&&(a=new Set(n));const i=a.has(e),o=c.has(r);if(i)if(o){const e=Qi(fe,r);e===u?u=Ue($e(r,s.element)):(s.withBefore(u).insertChild(e),$e(r,s.element)),f++,d++}else Ie(r,s.withBefore(u)),d++;else u=Ue(je(e)),Oe(e,s.element),f++}const i=me.get(r);null!==i&&In(i)&&(null===Te&&(Te=i.getFormat()),""===ve&&(ve=i.getStyle()))}const h=f>o,g=d>l;if(h&&!g){const t=n[l+1],r=void 0===t?null:fe.getElementByKey(t);Le(n,e,d,l,s.withBefore(r))}else g&&!h&&we(t,f,o,s.element)}(n,i,c,s,o,r)}Xi(n)&&(Ce+=L);l.__lexicalTextContent=Ce,Ce=i+Ce}(e,n,n.getDOMSlot(r)),Be(n,r),s=n,null==Te||Te===s.__textFormat||ke||(s.setTextFormat(Te),s.setTextStyle(ve)),function(e){""===ve||ve===e.__textStyle||ke||e.setTextStyle(ve)}(n),Se=i}function We(e,n){const r=[];let i=e.__first;for(;null!==i;){const e=n.get(i);void 0===e&&t(101),r.push(i),i=e.__next}return r}function $e(e,n){const r=pe.get(e);let i=me.get(e);void 0!==r&&void 0!==i||t(61);const s=be||_e.has(e)||ge.has(e),o=Qi(fe,e);if(r===i&&!s){if(Kr(r)){const e=o.__lexicalTextContent;void 0!==e&&(Ce+=e,Ne+=e);const t=o.__lexicalDirTextContent;void 0!==t&&(Se+=t)}else{const e=r.getTextContent();In(r)&&!r.isDirectionless()&&(Se+=e),Ne+=e,Ce+=e}return o}if(r!==i&&s&&Hi(xe,de,he,i,"updated"),i.updateDOM(r,o,ue)){const r=Ie(e,null);return null===n&&t(62),n.replaceChild(r,o),Oe(e,null),r}if(Kr(r)&&Kr(i)){const e=i.__indent;e!==r.__indent&&De(o,e);const t=i.__format;t!==r.__format&&Pe(o,t),s&&(ze(r,i,o),Yr(i)||i.isInline()||Re(r,i,o)),Xi(i)&&(Ce+=L,Ne+=L)}else{const t=i.getTextContent();if(jr(i)){const t=i.decorate(fe,ue);null!==t&&Ke(e,t)}else In(i)&&!i.isDirectionless()&&(Se+=t);Ce+=t,Ne+=t}if(!ke&&Yr(i)&&i.__cachedText!==Ne){const e=i.getWritable();e.__cachedText=Ne,i=e}return o}function Ke(e,t){let n=fe._pendingDecorators;const r=fe._decorators;if(null===n){if(r[e]===t)return;n=bi(fe)}n[e]=t}function Ue(e){let t=e.nextSibling;return null!==t&&t===fe._blockCursorElement&&(t=t.nextSibling),t}function Je(e,t,n,r,i,s){Ce="",Ne="",Se="",be=r===C,Ee=null,fe=n,ue=n._config,de=n._nodes,he=fe._listeners.mutation,ge=i,_e=s,pe=e._nodeMap,me=t._nodeMap,ke=t._readOnly,ye=new Map(n._keyToDOMMap);const o=new Map;return xe=o,$e("root",null),fe=void 0,de=void 0,ge=void 0,_e=void 0,pe=void 0,me=void 0,ue=void 0,ye=void 0,xe=void 0,o}function je(e){const n=ye.get(e);return void 0===n&&t(75,e),n}function He(e){return{}}const Ye={},Ve={},Ge={},qe={},Xe={},Qe={},Ze={},et={},tt={},nt={},rt={},it={},st={},ot={},lt={},ct={},at={},ut={},ft={},dt={},ht={},gt={},_t={},pt={},mt={},yt={},xt={},Ct={},St={},Tt={},vt={},Nt={},bt={},kt={},Et={},Ot={},wt={},Mt={},At={},Dt={},Pt={},It={},Lt={},Ft={},Rt={},Bt=Object.freeze({}),zt=30,Wt=[["keydown",function(e,t){if($t=e.timeStamp,Kt=e.key,t.isComposing())return;const{key:n,shiftKey:r,ctrlKey:o,metaKey:l,altKey:c}=e;if(qi(t,lt,e))return;if(null==n)return;if(qt&&Ki(Kt))return Br(t,(()=>{rn(t,Xt)})),qt=!1,void(Xt="");if(function(e,t,n,r){return zi(e)&&!t&&!r&&!n}(n,o,c,l))qi(t,ct,e);else if(function(e,t,n,r,i){return zi(e)&&!r&&!n&&(t||i)}(n,o,r,c,l))qi(t,at,e);else if(function(e,t,n,r){return Bi(e)&&!t&&!r&&!n}(n,o,c,l))qi(t,ut,e);else if(function(e,t,n,r,i){return Bi(e)&&!r&&!n&&(t||i)}(n,o,r,c,l))qi(t,ft,e);else if(function(e,t,n){return function(e){return"ArrowUp"===e}(e)&&!t&&!n}(n,o,l))qi(t,dt,e);else if(function(e,t,n){return function(e){return"ArrowDown"===e}(e)&&!t&&!n}(n,o,l))qi(t,ht,e);else if(function(e,t){return $i(e)&&t}(n,r))Vt=!0,qi(t,gt,e);else if(function(e){return" "===e}(n))qi(t,_t,e);else if(function(e,t){return i&&t&&"o"===e.toLowerCase()}(n,o))e.preventDefault(),Vt=!0,qi(t,Xe,!0);else if(function(e,t){return $i(e)&&!t}(n,r))Vt=!1,qi(t,gt,e);else if(function(e,t,n,r){if(i)return!t&&!n&&(Ki(e)||"h"===e.toLowerCase()&&r);if(r||t||n)return!1;return Ki(e)}(n,c,l,o))Ki(n)?qi(t,pt,e):(e.preventDefault(),qi(t,qe,!0));else if(function(e){return"Escape"===e}(n))qi(t,mt,e);else if(function(e,t,n,r,s){if(i)return!(n||r||s)&&(Ui(e)||"d"===e.toLowerCase()&&t);if(t||r||s)return!1;return Ui(e)}(n,o,r,c,l))Ui(n)?qi(t,yt,e):(e.preventDefault(),qi(t,qe,!1));else if(function(e,t,n){return Ki(e)&&(i?t:n)}(n,c,o))e.preventDefault(),qi(t,nt,!0);else if(function(e,t,n){return Ui(e)&&(i?t:n)}(n,c,o))e.preventDefault(),qi(t,nt,!1);else if(function(e,t){return i&&t&&Ki(e)}(n,l))e.preventDefault(),qi(t,rt,!0);else if(function(e,t){return i&&t&&Ui(e)}(n,l))e.preventDefault(),qi(t,rt,!1);else if(function(e,t,n,r){return"b"===e.toLowerCase()&&!t&&Wi(n,r)}(n,c,l,o))e.preventDefault(),qi(t,it,"bold");else if(function(e,t,n,r){return"u"===e.toLowerCase()&&!t&&Wi(n,r)}(n,c,l,o))e.preventDefault(),qi(t,it,"underline");else if(function(e,t,n,r){return"i"===e.toLowerCase()&&!t&&Wi(n,r)}(n,c,l,o))e.preventDefault(),qi(t,it,"italic");else if(function(e,t,n,r){return"Tab"===e&&!t&&!n&&!r}(n,c,o,l))qi(t,xt,e);else if(function(e,t,n,r){return"z"===e.toLowerCase()&&!t&&Wi(n,r)}(n,r,l,o))e.preventDefault(),qi(t,st,void 0);else if(function(e,t,n,r){if(i)return"z"===e.toLowerCase()&&n&&t;return"y"===e.toLowerCase()&&r||"z"===e.toLowerCase()&&r&&t}(n,r,l,o))e.preventDefault(),qi(t,ot,void 0);else{const c=t._editorState._selection;null===c||Jn(c)?!s&&Ji(n,l,o)&&(e.preventDefault(),qi(t,Mt,e)):!function(e,t,n,r){if(t)return!1;if("c"===e.toLowerCase())return i?n:r;return!1}(n,r,l,o)?!function(e,t,n,r){if(t)return!1;if("x"===e.toLowerCase())return i?n:r;return!1}(n,r,l,o)?Ji(n,l,o)&&(e.preventDefault(),qi(t,Mt,e)):(e.preventDefault(),qi(t,wt,e)):(e.preventDefault(),qi(t,Ot,e))}(function(e,t,n,r){return e||t||n||r})(o,r,c,l)&&qi(t,Rt,e)}],["pointerdown",function(e,t){const n=e.target,r=e.pointerType;ms(n)&&"touch"!==r&&0===e.button&&Br(t,(()=>{jr(Ni(n))||(Yt=!0)}))}],["compositionstart",function(e,t){Br(t,(()=>{const n=or();if(Jn(n)&&!t.isComposing()){const r=n.anchor,i=n.anchor.getNode();xi(r.key),(e.timeStamp<$t+zt||"element"===r.type||!n.isCollapsed()||i.getFormat()!==n.format||In(i)&&i.getStyle()!==n.style)&&qi(t,Ze,F)}}))}],["compositionend",function(e,t){s?Gt=!0:c||!l&&!d?Br(t,(()=>{rn(t,e.data)})):(qt=!0,Xt=e.data)}],["input",function(e,t){e.stopPropagation(),Br(t,(()=>{const n=or(),r=e.data,i=nn(e);if(null!=r&&Jn(n)&&Zt(n,i,r,e.timeStamp,!1)){Gt&&(rn(t,r),Gt=!1);const i=n.anchor.getNode(),a=gs(ss(t));if(null===a)return;const u=n.isBackward(),f=u?n.anchor.offset:n.focus.offset,h=u?n.focus.offset:n.anchor.offset;o&&!n.isCollapsed()&&In(i)&&null!==a.anchorNode&&i.getTextContent().slice(0,f)+r+i.getTextContent().slice(f+h)===Li(a.anchorNode)||qi(t,Ze,r);const g=r.length;s&&g>1&&"insertCompositionText"===e.inputType&&!t.isComposing()&&(n.anchor.offset-=g),l||c||d||!t.isComposing()||($t=0,xi(null))}else{Fi(!1,t,null!==r?r:void 0),Gt&&(rn(t,r||void 0),Gt=!1)}!function(){Tr();const e=br();re(e)}()}),{event:e}),Jt=null}],["click",function(e,t){Br(t,(()=>{const n=or(),r=gs(ss(t)),i=lr();if(r)if(Jn(n)){const t=n.anchor,s=t.getNode();if("element"===t.type&&0===t.offset&&n.isCollapsed()&&!Yr(s)&&1===Ei().getChildrenSize()&&s.getTopLevelElementOrThrow().isEmpty()&&null!==i&&n.is(i))r.removeAllRanges(),n.dirty=!0;else if(3===e.detail&&!n.isCollapsed()){if(s!==n.focus.getNode()){const e=function(e,t){let n=e;for(;n!==Ei()&&null!=n;){if(t(n))return n;n=n.getParent()}return null}(s,(e=>Kr(e)&&!e.isInline()));Kr(e)&&e.select(0)}}}else if("touch"===e.pointerType){const n=r.anchorNode;if(ps(n)||di(n)){wi(sr(i,r,t,e))}}qi(t,Ge,e)}))}],["cut",Bt],["copy",Bt],["dragstart",Bt],["dragover",Bt],["dragend",Bt],["paste",Bt],["focus",Bt],["blur",Bt],["drop",Bt]];o&&Wt.push(["beforeinput",(e,n)=>function(e,n){const r=e.inputType,i=nn(e);if("deleteCompositionText"===r||s&&Gi(n))return;if("insertCompositionText"===r)return;Br(n,(()=>{const s=or();if("deleteContentBackward"===r){if(null===s){const e=lr();if(!Jn(e))return;wi(e.clone())}if(Jn(s)){const r=s.anchor.key===s.focus.key;if(o=e.timeStamp,"MediaLast"===Kt&&o<$t+zt&&n.isComposing()&&r){if(xi(null),$t=0,setTimeout((()=>{Br(n,(()=>{xi(null)}))}),zt),Jn(s)){const e=s.anchor.getNode();e.markDirty(),s.format=e.getFormat(),In(e)||t(142),s.style=e.getStyle()}}else{xi(null),e.preventDefault();const t=s.anchor.getNode(),i=t.getTextContent(),o=t.canInsertTextAfter(),l=0===s.anchor.offset&&s.focus.offset===i.length;let c=f&&r&&!l&&o;c&&s.isCollapsed()&&(c=!jr(Vi(s.anchor,!0))),c||qi(n,qe,!0)}return}}var o;if(!Jn(s))return;const l=e.data;null!==Jt&&Fi(!1,n,Jt),s.dirty&&null===Jt||!s.isCollapsed()||Yr(s.anchor.getNode())||null===i||s.applyDOMRange(i),Jt=null;const a=s.anchor,u=s.focus,d=a.getNode(),h=u.getNode();if("insertText"!==r&&"insertTranspose"!==r)switch(e.preventDefault(),r){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":qi(n,Ze,e);break;case"insertFromComposition":xi(null),qi(n,Ze,e);break;case"insertLineBreak":xi(null),qi(n,Xe,!1);break;case"insertParagraph":xi(null),Vt&&!c?(Vt=!1,qi(n,Xe,!1)):qi(n,Qe,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":qi(n,et,e);break;case"deleteByComposition":(function(e,t){return e!==t||Kr(e)||Kr(t)||!e.isToken()||!t.isToken()})(d,h)&&qi(n,tt,e);break;case"deleteByDrag":case"deleteByCut":qi(n,tt,e);break;case"deleteContent":qi(n,qe,!1);break;case"deleteWordBackward":qi(n,nt,!0);break;case"deleteWordForward":qi(n,nt,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":qi(n,rt,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":qi(n,rt,!1);break;case"formatStrikeThrough":qi(n,it,"strikethrough");break;case"formatBold":qi(n,it,"bold");break;case"formatItalic":qi(n,it,"italic");break;case"formatUnderline":qi(n,it,"underline");break;case"historyUndo":qi(n,st,void 0);break;case"historyRedo":qi(n,ot,void 0)}else{if("\n"===l)e.preventDefault(),qi(n,Xe,!1);else if(l===L)e.preventDefault(),qi(n,Qe,void 0);else if(null==l&&e.dataTransfer){const t=e.dataTransfer.getData("text/plain");e.preventDefault(),s.insertRawText(t)}else null!=l&&Zt(s,i,l,e.timeStamp,!0)?(e.preventDefault(),qi(n,Ze,l)):Jt=l;Ut=e.timeStamp}}))}(e,n)]);let $t=0,Kt=null,Ut=0,Jt=null;const jt=new WeakMap;let Ht=!1,Yt=!1,Vt=!1,Gt=!1,qt=!1,Xt="",Qt=[0,"",0,"root",0];function Zt(e,t,n,r,i){const s=e.anchor,l=e.focus,c=s.getNode(),a=br(),u=gs(ss(a)),f=null!==u?u.anchorNode:null,d=s.key,h=a.getElementByKey(d),g=n.length;return d!==l.key||!In(c)||(!i&&(!o||Ut<r+50)||c.isDirty()&&g<2||Di(n))&&s.offset!==l.offset&&!c.isComposing()||fi(c)||c.isDirty()&&g>1||(i||!o)&&null!==h&&!c.isComposing()&&f!==gi(h)||null!==u&&null!==t&&(!t.collapsed||t.startContainer!==u.anchorNode||t.startOffset!==u.anchorOffset)||c.getFormat()!==e.format||c.getStyle()!==e.style||function(e,t){if(t.isSegmented())return!0;if(!e.isCollapsed())return!1;const n=e.anchor.offset,r=t.getParentOrThrow(),i=t.isToken();return 0===n?!t.canInsertTextBefore()||!r.canInsertTextBefore()&&!t.isComposing()||i||function(e){const t=e.getPreviousSibling();return(In(t)||Kr(t)&&t.isInline())&&!t.canInsertTextAfter()}(t):n===t.getTextContentSize()&&(!t.canInsertTextAfter()||!r.canInsertTextAfter()&&!t.isComposing()||i)}(e,c)}function en(e,t){return di(e)&&null!==e.nodeValue&&0!==t&&t!==e.nodeValue.length}function tn(e,n,r){const{anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:l}=e;Ht&&(Ht=!1,en(i,s)&&en(o,l))||Br(n,(()=>{if(!r)return void wi(null);if(!li(n,i,o))return;const c=or();if(Jn(c)){const r=c.anchor,i=r.getNode();if(c.isCollapsed()){"Range"===e.type&&e.anchorNode===e.focusNode&&(c.dirty=!0);const s=ss(n).event,o=s?s.timeStamp:performance.now(),[l,a,u,f,d]=Qt,h=Ei(),g=!1===n.isComposing()&&""===h.getTextContent();if(o<d+200&&r.offset===u&&r.key===f)c.format=l,c.style=a;else if("text"===r.type)In(i)||t(141),c.format=i.getFormat(),c.style=i.getStyle();else if("element"===r.type&&!g){Kr(i)||t(259);const e=r.getNode();c.style="",e.isEmpty()?(c.format=e.getTextFormat(),c.style=e.getTextStyle()):c.format=0}}else{const e=r.key,t=c.focus.key,n=c.getNodes(),i=n.length,o=c.isBackward(),a=o?l:s,u=o?s:l,f=o?t:e,d=o?e:t;let h=E,g=!1;for(let e=0;e<i;e++){const t=n[e],r=t.getTextContentSize();if(In(t)&&0!==r&&!(0===e&&t.__key===f&&a===r||e===i-1&&t.__key===d&&0===u)&&(g=!0,h&=t.getFormat(),0===h))break}c.format=g?h:0}}qi(n,Ye,void 0)}))}function nn(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return 0===t.length?null:t[0]}function rn(e,t){const n=e._compositionKey;if(xi(null),null!==n&&null!=t){if(""===t){const t=Si(n),r=gi(e.getElementByKey(n));return void(null!==r&&null!==r.nodeValue&&In(t)&&Ri(t,r.nodeValue,null,null,!0))}if("\n"===t[t.length-1]){const t=or();if(Jn(t)){const n=t.focus;return t.anchor.set(n.key,n.offset,n.type),void qi(e,gt,null)}}}Fi(!0,e,t)}function sn(e){let t=e.__lexicalEventHandles;return void 0===t&&(t=[],e.__lexicalEventHandles=t),t}const on=new Map;function ln(e){const t=_s(e.target);if(null===t)return;const n=ai(t.anchorNode);if(null===n)return;Yt&&(Yt=!1,Br(n,(()=>{const r=lr(),i=t.anchorNode;if(ps(i)||di(i)){wi(sr(r,t,n,e))}})));const r=Pi(n),i=r[r.length-1],s=i._key,o=on.get(s),l=o||i;l!==n&&tn(t,l,!1),tn(t,n,!0),n!==i?on.set(s,n):o&&on.delete(s)}function cn(e){e._lexicalHandled=!0}function an(e){return!0===e._lexicalHandled}function un(e){const n=e.ownerDocument,r=jt.get(n);void 0===r&&t(162);const i=r-1;i>=0||t(164),jt.set(n,i),0===i&&n.removeEventListener("selectionchange",ln);const s=ui(e);ci(s)?(!function(e){if(null!==e._parentEditor){const t=Pi(e),n=t[t.length-1]._key;on.get(n)===e&&on.delete(n)}else on.delete(e._key)}(s),e.__lexicalEditor=null):s&&t(198);const o=sn(e);for(let e=0;e<o.length;e++)o[e]();e.__lexicalEventHandles=[]}function fn(e,t,n){Tr();const r=e.__key,i=e.getParent();if(null===i)return;const s=function(e){const t=or();if(!Jn(t)||!Kr(e))return t;const{anchor:n,focus:r}=t,i=n.getNode(),s=r.getNode();rs(i,e)&&n.set(e.__key,0,"element");rs(s,e)&&r.set(e.__key,0,"element");return t}(e);let o=!1;if(Jn(s)&&t){const t=s.anchor,n=s.focus;t.key===r&&(ur(t,e,i,e.getPreviousSibling(),e.getNextSibling()),o=!0),n.key===r&&(ur(n,e,i,e.getPreviousSibling(),e.getNextSibling()),o=!0)}else Hn(s)&&t&&e.isSelected()&&e.selectPrevious();if(Jn(s)&&t&&!o){const t=e.getIndexWithinParent();mi(e),cr(s,i,t,-1)}else mi(e);n||ls(i)||i.canBeEmpty()||!i.isEmpty()||fn(i,t),t&&Yr(i)&&i.isEmpty()&&i.selectEnd()}class dn{static getType(){t(64,this.name)}static clone(e){t(65,this.name)}afterCloneFrom(e){this.__parent=e.__parent,this.__next=e.__next,this.__prev=e.__prev}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,pi(this,e)}getType(){return this.__type}isInline(){t(137,this.constructor.name)}isAttached(){let e=this.__key;for(;null!==e;){if("root"===e)return!0;const t=Si(e);if(null===t)break;e=t.__parent}return!1}isSelected(e){const t=e||or();if(null==t)return!1;const n=t.getNodes().some((e=>e.__key===this.__key));if(In(this))return n;if(Jn(t)&&"element"===t.anchor.type&&"element"===t.focus.type){if(t.isCollapsed())return!1;const e=this.getParent();if(jr(this)&&this.isInline()&&e){const n=t.isBackward()?t.focus:t.anchor;if(e.is(n.getNode())&&n.offset===e.getChildrenSize()&&this.is(e.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(null===e)return-1;let t=e.getFirstChild(),n=0;for(;null!==t;){if(this.is(t))return n;n++,t=t.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return null===e?null:Si(e)}getParentOrThrow(){const e=this.getParent();return null===e&&t(66,this.__key),e}getTopLevelElement(){let e=this;for(;null!==e;){const n=e.getParent();if(ls(n))return Kr(e)||e===this&&jr(e)||t(194),e;e=n}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return null===e&&t(67,this.__key),e}getParents(){const e=[];let t=this.getParent();for(;null!==t;)e.push(t),t=t.getParent();return e}getParentKeys(){const e=[];let t=this.getParent();for(;null!==t;)e.push(t.__key),t=t.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return null===e?null:Si(e)}getPreviousSiblings(){const e=[],t=this.getParent();if(null===t)return e;let n=t.getFirstChild();for(;null!==n&&!n.is(this);)e.push(n),n=n.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return null===e?null:Si(e)}getNextSiblings(){const e=[];let t=this.getNextSibling();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getCommonAncestor(e){const t=this.getParents(),n=e.getParents();Kr(this)&&t.unshift(this),Kr(e)&&n.unshift(e);const r=t.length,i=n.length;if(0===r||0===i||t[r-1]!==n[i-1])return null;const s=new Set(n);for(let e=0;e<r;e++){const n=t[e];if(s.has(n))return n}return null}is(e){return null!=e&&this.__key===e.__key}isBefore(e){if(this===e)return!1;if(e.isParentOf(this))return!0;if(this.isParentOf(e))return!1;const t=this.getCommonAncestor(e);let n=0,r=0,i=this;for(;;){const e=i.getParentOrThrow();if(e===t){n=i.getIndexWithinParent();break}i=e}for(i=e;;){const e=i.getParentOrThrow();if(e===t){r=i.getIndexWithinParent();break}i=e}return n<r}isParentOf(e){const t=this.__key;if(t===e.__key)return!1;let n=e;for(;null!==n;){if(n.__key===t)return!0;n=n.getParent()}return!1}getNodesBetween(e){const n=this.isBefore(e),r=[],i=new Set;let s=this;for(;null!==s;){const o=s.__key;if(i.has(o)||(i.add(o),r.push(s)),s===e)break;const l=Kr(s)?n?s.getFirstChild():s.getLastChild():null;if(null!==l){s=l;continue}const c=n?s.getNextSibling():s.getPreviousSibling();if(null!==c){s=c;continue}const a=s.getParentOrThrow();if(i.has(a.__key)||r.push(a),a===e)break;let u=null,f=a;do{if(null===f&&t(68),u=n?f.getNextSibling():f.getPreviousSibling(),f=f.getParent(),null===f)break;null!==u||i.has(f.__key)||r.push(f)}while(null===u);s=u}return n||r.reverse(),r}isDirty(){const e=br()._dirtyLeaves;return null!==e&&e.has(this.__key)}getLatest(){const e=Si(this.__key);return null===e&&t(113),e}getWritable(){Tr();const e=Nr(),t=br(),n=e._nodeMap,r=this.__key,i=this.getLatest(),s=t._cloneNotNeeded,o=or();if(null!==o&&o.setCachedNodes(null),s.has(r))return yi(i),i;const l=ks(i);return s.add(r),yi(l),n.set(r,l),l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,n){t(70)}updateDOM(e,n,r){t(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){return{type:this.__type,version:1}}static importJSON(e){t(18,this.name)}updateFromJSON(e){return this}static transform(){return null}remove(e){fn(this,!0,e)}replace(e,n){Tr();let r=or();null!==r&&(r=r.clone()),us(this,e);const i=this.getLatest(),s=this.__key,o=e.__key,l=e.getWritable(),c=this.getParentOrThrow().getWritable(),a=c.__size;mi(l);const u=i.getPreviousSibling(),f=i.getNextSibling(),d=i.__prev,h=i.__next,g=i.__parent;if(fn(i,!1,!0),null===u)c.__first=o;else{u.getWritable().__next=o}if(l.__prev=d,null===f)c.__last=o;else{f.getWritable().__prev=o}if(l.__next=h,l.__parent=g,c.__size=a,n&&(Kr(this)&&Kr(l)||t(139),this.getChildren().forEach((e=>{l.append(e)}))),Jn(r)){wi(r);const e=r.anchor,t=r.focus;e.key===s&&Kn(e,l),t.key===s&&Kn(t,l)}return Ci()===s&&xi(o),l}insertAfter(e,t=!0){Tr(),us(this,e);const n=this.getWritable(),r=e.getWritable(),i=r.getParent(),s=or();let o=!1,l=!1;if(null!==i){const t=e.getIndexWithinParent();if(mi(r),Jn(s)){const e=i.__key,n=s.anchor,r=s.focus;o="element"===n.type&&n.key===e&&n.offset===t+1,l="element"===r.type&&r.key===e&&r.offset===t+1}}const c=this.getNextSibling(),a=this.getParentOrThrow().getWritable(),u=r.__key,f=n.__next;if(null===c)a.__last=u;else{c.getWritable().__prev=u}if(a.__size++,n.__next=u,r.__next=f,r.__prev=n.__key,r.__parent=n.__parent,t&&Jn(s)){const e=this.getIndexWithinParent();cr(s,a,e+1);const t=a.__key;o&&s.anchor.set(t,e+2,"element"),l&&s.focus.set(t,e+2,"element")}return e}insertBefore(e,t=!0){Tr(),us(this,e);const n=this.getWritable(),r=e.getWritable(),i=r.__key;mi(r);const s=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),l=n.__prev,c=this.getIndexWithinParent();if(null===s)o.__first=i;else{s.getWritable().__next=i}o.__size++,n.__prev=i,r.__prev=l,r.__next=n.__key,r.__parent=n.__parent;const a=or();if(t&&Jn(a)){cr(a,this.getParentOrThrow(),c)}return e}isParentRequired(){return!1}createParentElementNode(){return ti()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,t){Tr();const n=this.getPreviousSibling(),r=this.getParentOrThrow();if(null===n)return r.select(0,0);if(Kr(n))return n.select();if(!In(n)){const e=n.getIndexWithinParent()+1;return r.select(e,e)}return n.select(e,t)}selectNext(e,t){Tr();const n=this.getNextSibling(),r=this.getParentOrThrow();if(null===n)return r.select();if(Kr(n))return n.select(0,0);if(!In(n)){const e=n.getIndexWithinParent();return r.select(e,e)}return n.select(e,t)}markDirty(){this.getWritable()}reconcileObservedMutation(e,t){this.markDirty()}}class hn extends dn{static getType(){return"linebreak"}static clone(e){return new hn(e.__key)}constructor(e){super(e)}getTextContent(){return"\n"}createDOM(){return document.createElement("br")}updateDOM(){return!1}static importDOM(){return{br:e=>function(e){const t=e.parentElement;if(null!==t&&Cs(t)){const n=t.firstChild;if(n===e||n.nextSibling===e&&mn(n)){const n=t.lastChild;if(n===e||n.previousSibling===e&&mn(n))return!0}}return!1}(e)||function(e){const t=e.parentElement;if(null!==t&&Cs(t)){const n=t.firstChild;if(n===e||n.nextSibling===e&&mn(n))return!1;const r=t.lastChild;if(r===e||r.previousSibling===e&&mn(r))return!0}return!1}(e)?null:{conversion:gn,priority:0}}}static importJSON(e){return _n().updateFromJSON(e)}}function gn(e){return{node:_n()}}function _n(){return as(new hn)}function pn(e){return e instanceof hn}function mn(e){return di(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function yn(e,t){return 16&t?"code":t&k?"mark":32&t?"sub":64&t?"sup":null}function xn(e,t){return 1&t?"strong":2&t?"em":"span"}function Cn(e,t,n,r,i){const s=r.classList;let o=ji(i,"base");void 0!==o&&s.add(...o),o=ji(i,"underlineStrikethrough");let l=!1;const c=t&b&&t&N;void 0!==o&&(n&b&&n&N?(l=!0,c||s.add(...o)):c&&s.remove(...o));for(const e in $){const r=$[e];if(o=ji(i,e),void 0!==o)if(n&r){if(l&&("underline"===e||"strikethrough"===e)){t&r&&s.remove(...o);continue}t&r&&(!c||"underline"!==e)&&"strikethrough"!==e||s.add(...o)}else t&r&&s.remove(...o)}}function Sn(e,t,n){const r=t.firstChild,i=n.isComposing(),o=e+(i?I:"");if(null==r)t.textContent=o;else{const e=r.nodeValue;if(e!==o)if(i||s){const[t,n,i]=function(e,t){const n=e.length,r=t.length;let i=0,s=0;for(;i<n&&i<r&&e[i]===t[i];)i++;for(;s+i<n&&s+i<r&&e[n-s-1]===t[r-s-1];)s++;return[i,n-i-s,t.slice(i,r-s)]}(e,o);0!==n&&r.deleteData(t,n),r.insertData(t,i)}else r.nodeValue=o}}function Tn(e,t,n,r,i,s){Sn(i,e,t);const o=s.theme.text;void 0!==o&&Cn(0,0,r,e,o)}function vn(e,t){const n=document.createElement(t);return n.appendChild(e),n}class Nn extends dn{static getType(){return"text"}static clone(e){return new Nn(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__text=e.__text,this.__format=e.__format,this.__style=e.__style,this.__mode=e.__mode,this.__detail=e.__detail}constructor(e="",t){super(t),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return H[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return 1===this.getLatest().__mode}isComposing(){return this.__key===Ci()}isSegmented(){return 2===this.getLatest().__mode}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const t=$[e];return!!(this.getFormat()&t)}isSimpleText(){return"text"===this.__type&&0===this.__mode}getTextContent(){return this.getLatest().__text}getFormatFlags(e,t){return _i(this.getLatest().__format,e,t)}canHaveFormat(){return!0}createDOM(e,t){const n=this.__format,r=yn(0,n),i=xn(0,n),s=null===r?i:r,o=document.createElement(s);let l=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),null!==r&&(l=document.createElement(i),o.appendChild(l));Tn(l,this,0,n,this.__text,e);const c=this.__style;return""!==c&&(o.style.cssText=c),o}updateDOM(e,n,r){const i=this.__text,s=e.__format,o=this.__format,l=yn(0,s),c=yn(0,o),a=xn(0,s),u=xn(0,o);if((null===l?a:l)!==(null===c?u:c))return!0;if(l===c&&a!==u){const e=n.firstChild;null==e&&t(48);const s=document.createElement(u);return Tn(s,this,0,o,i,r),n.replaceChild(s,e),!1}let f=n;null!==c&&null!==l&&(f=n.firstChild,null==f&&t(49)),Sn(i,f,this);const d=r.theme.text;void 0!==d&&s!==o&&Cn(0,s,o,f,d);const h=e.__style,g=this.__style;return h!==g&&(n.style.cssText=g),!1}static importDOM(){return{"#text":()=>({conversion:wn,priority:0}),b:()=>({conversion:kn,priority:0}),code:()=>({conversion:Dn,priority:0}),em:()=>({conversion:Dn,priority:0}),i:()=>({conversion:Dn,priority:0}),mark:()=>({conversion:Dn,priority:0}),s:()=>({conversion:Dn,priority:0}),span:()=>({conversion:bn,priority:0}),strong:()=>({conversion:Dn,priority:0}),sub:()=>({conversion:Dn,priority:0}),sup:()=>({conversion:Dn,priority:0}),u:()=>({conversion:Dn,priority:0})}}static importJSON(e){return Pn().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextContent(e.text).setFormat(e.format).setDetail(e.detail).setMode(e.mode).setStyle(e.style)}exportDOM(e){let{element:n}=super.exportDOM(e);return ps(n)||t(132),n.style.whiteSpace="pre-wrap",this.hasFormat("bold")&&(n=vn(n,"b")),this.hasFormat("italic")&&(n=vn(n,"i")),this.hasFormat("strikethrough")&&(n=vn(n,"s")),this.hasFormat("underline")&&(n=vn(n,"u")),{element:n}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(e,t){}setFormat(e){const t=this.getWritable();return t.__format="string"==typeof e?$[e]:e,t}setDetail(e){const t=this.getWritable();return t.__detail="string"==typeof e?K[e]:e,t}setStyle(e){const t=this.getWritable();return t.__style=e,t}toggleFormat(e){const t=_i(this.getFormat(),e,null);return this.setFormat(t)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const t=j[e];if(this.__mode===t)return this;const n=this.getWritable();return n.__mode=t,n}setTextContent(e){if(this.__text===e)return this;const t=this.getWritable();return t.__text=e,t}select(e,t){Tr();let n=e,r=t;const i=or(),s=this.getTextContent(),o=this.__key;if("string"==typeof s){const e=s.length;void 0===n&&(n=e),void 0===r&&(r=e)}else n=0,r=0;if(!Jn(i))return nr(o,n,o,r,"text","text");{const e=Ci();e!==i.anchor.key&&e!==i.focus.key||xi(o),i.setTextNodeRange(this,n,this,r)}return i}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,t,n,r){const i=this.getWritable(),s=i.__text,o=n.length;let l=e;l<0&&(l=o+l,l<0&&(l=0));const c=or();if(r&&Jn(c)){const t=e+o;c.setTextNodeRange(i,t,i,t)}const a=s.slice(0,l)+n+s.slice(l+t);return i.__text=a,i}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){Tr();const t=this.getLatest(),n=t.getTextContent();if(""===n)return[];const r=t.__key,i=Ci(),s=n.length;e.sort(((e,t)=>e-t)),e.push(s);const o=[],l=e.length;for(let t=0,r=0;t<s&&r<=l;r++){const i=e[r];i>t&&(o.push(n.slice(t,i)),t=i)}const c=o.length;if(1===c)return[t];const a=o[0],u=t.getParent();let f;const d=t.getFormat(),h=t.getStyle(),g=t.__detail;let _=!1,p=null,m=null;const y=or();if(Jn(y)){const[e,t]=y.isBackward()?[y.focus,y.anchor]:[y.anchor,y.focus];"text"===e.type&&e.key===r&&(p=e),"text"===t.type&&t.key===r&&(m=t)}t.isSegmented()?(f=Pn(a),f.__format=d,f.__style=h,f.__detail=g,_=!0):(f=t.getWritable(),f.__text=a);const x=[f];for(let e=1;e<c;e++){const t=Pn(o[e]);t.__format=d,t.__style=h,t.__detail=g;const n=t.__key;i===r&&xi(n),x.push(t)}const C=p?p.offset:null,S=m?m.offset:null;let T=0;for(const e of x){if(!p&&!m)break;const t=T+e.getTextContentSize();if(null!==p&&null!==C&&C<=t&&C>=T&&(p.set(e.getKey(),C-T,"text"),C<t&&(p=null)),null!==m&&null!==S&&S<=t&&S>=T){m.set(e.getKey(),S-T,"text");break}T=t}if(null!==u){!function(e){const t=e.getPreviousSibling(),n=e.getNextSibling();null!==t&&yi(t);null!==n&&yi(n)}(this);const e=u.getWritable(),t=this.getIndexWithinParent();_?(e.splice(t,0,x),this.remove()):e.splice(t,1,x),Jn(y)&&cr(y,u,t,c-1)}return x}mergeWithSibling(e){const n=e===this.getPreviousSibling();n||e===this.getNextSibling()||t(50);const r=this.__key,i=e.__key,s=this.__text,o=s.length;Ci()===i&&xi(r);const l=or();if(Jn(l)){const t=l.anchor,s=l.focus;null!==t&&t.key===i&&fr(t,n,r,e,o),null!==s&&s.key===i&&fr(s,n,r,e,o)}const c=e.__text,a=n?c+s:s+c;this.setTextContent(a);const u=this.getWritable();return e.remove(),u}isTextEntity(){return!1}}function bn(e){return{forChild:Ln(e.style),node:null}}function kn(e){const t=e,n="normal"===t.style.fontWeight;return{forChild:Ln(t.style,n?void 0:"bold"),node:null}}const En=new WeakMap;function On(e){if(!ps(e))return!1;if("PRE"===e.nodeName)return!0;const t=e.style.whiteSpace;return"string"==typeof t&&t.startsWith("pre")}function wn(e){const n=e;null===e.parentElement&&t(129);let r=n.textContent||"";if(null!==function(e){let t,n=e.parentNode;const r=[e];for(;null!==n&&void 0===(t=En.get(n))&&!On(n);)r.push(n),n=n.parentNode;const i=void 0===t?n:t;for(let e=0;e<r.length;e++)En.set(r[e],i);return i}(n)){const e=r.split(/(\r?\n|\t)/),t=[],n=e.length;for(let r=0;r<n;r++){const n=e[r];"\n"===n||"\r\n"===n?t.push(_n()):"\t"===n?t.push(Rn()):""!==n&&t.push(Pn(n))}return{node:t}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),""===r)return{node:null};if(" "===r[0]){let e=n,t=!0;for(;null!==e&&null!==(e=Mn(e,!1));){const n=e.textContent||"";if(n.length>0){/[ \t\n]$/.test(n)&&(r=r.slice(1)),t=!1;break}}t&&(r=r.slice(1))}if(" "===r[r.length-1]){let e=n,t=!0;for(;null!==e&&null!==(e=Mn(e,!0));){if((e.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){t=!1;break}}t&&(r=r.slice(0,r.length-1))}return""===r?{node:null}:{node:Pn(r)}}function Mn(e,t){let n=e;for(;;){let e;for(;null===(e=t?n.nextSibling:n.previousSibling);){const e=n.parentElement;if(null===e)return null;n=e}if(n=e,ps(n)){const e=n.style.display;if(""===e&&!xs(n)||""!==e&&!e.startsWith("inline"))return null}let r=n;for(;null!==(r=t?n.firstChild:n.lastChild);)n=r;if(di(n))return n;if("BR"===n.nodeName)return null}}const An={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Dn(e){const t=An[e.nodeName.toLowerCase()];return void 0===t?{node:null}:{forChild:Ln(e.style,t),node:null}}function Pn(e=""){return as(new Nn(e))}function In(e){return e instanceof Nn}function Ln(e,t){const n=e.fontWeight,r=e.textDecoration.split(" "),i="700"===n||"bold"===n,s=r.includes("line-through"),o="italic"===e.fontStyle,l=r.includes("underline"),c=e.verticalAlign;return e=>In(e)?(i&&!e.hasFormat("bold")&&e.toggleFormat("bold"),s&&!e.hasFormat("strikethrough")&&e.toggleFormat("strikethrough"),o&&!e.hasFormat("italic")&&e.toggleFormat("italic"),l&&!e.hasFormat("underline")&&e.toggleFormat("underline"),"sub"!==c||e.hasFormat("subscript")||e.toggleFormat("subscript"),"super"!==c||e.hasFormat("superscript")||e.toggleFormat("superscript"),t&&!e.hasFormat(t)&&e.toggleFormat(t),e):e}class Fn extends Nn{static getType(){return"tab"}static clone(e){return new Fn(e.__key)}constructor(e){super("\t",e),this.__detail=2}static importDOM(){return null}createDOM(e){const t=super.createDOM(e),n=ji(e.theme,"tab");if(void 0!==n){t.classList.add(...n)}return t}static importJSON(e){return Rn().updateFromJSON(e)}setTextContent(e){return"\t"!==e&&""!==e&&t(126),super.setTextContent(e)}setDetail(e){return 2!==e&&t(127),this}setMode(e){return"normal"!==e&&t(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function Rn(){return as(new Fn)}function Bn(e){return e instanceof Fn}class zn{constructor(e,t,n){this._selection=null,this.key=e,this.offset=t,this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){let t=this.getNode(),n=e.getNode();const r=this.offset,i=e.offset;if(Kr(t)){const e=t.getDescendantByIndex(r);t=null!=e?e:t}if(Kr(n)){const e=n.getDescendantByIndex(i);n=null!=e?e:n}return t===n?r<i:t.isBefore(n)}getNode(){const e=Si(this.key);return null===e&&t(20),e}set(e,t,n,r){const i=this._selection,s=this.key;r&&this.key===e&&this.offset===t&&this.type===n||(this.key=e,this.offset=t,this.type=n,Sr()||(Ci()===s&&xi(e),null!==i&&(i.setCachedNodes(null),i.dirty=!0)))}}function Wn(e,t,n){return new zn(e,t,n)}function $n(e,t){let n=t.__key,r=e.offset,i="element";if(In(t)){i="text";const e=t.getTextContentSize();r>e&&(r=e)}else if(!Kr(t)){const e=t.getNextSibling();if(In(e))n=e.__key,r=0,i="text";else{const e=t.getParent();e&&(n=e.__key,r=t.getIndexWithinParent()+1)}}e.set(n,r,i)}function Kn(e,t){if(Kr(t)){const n=t.getLastDescendant();Kr(n)||In(n)?$n(e,n):$n(e,t)}else $n(e,t)}class Un{constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Hn(e))return!1;const t=this._nodes,n=e._nodes;return t.size===n.size&&Array.from(t).every((e=>n.has(e)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new Un(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.getNodes(),n=t.length,r=t[n-1];let i;if(In(r))i=r.select();else{const e=r.getIndexWithinParent()+1;i=r.getParentOrThrow().select(e,e)}i.insertNodes(e);for(let e=0;e<n;e++)t[e].remove()}getNodes(){const e=this._cachedNodes;if(null!==e)return e;const t=this._nodes,n=[];for(const e of t){const t=Si(e);null!==t&&n.push(t)}return Sr()||(this._cachedNodes=n),n}getTextContent(){const e=this.getNodes();let t="";for(let n=0;n<e.length;n++)t+=e[n].getTextContent();return t}}function Jn(e){return e instanceof jn}class jn{constructor(e,t,n,r){this.anchor=e,this.focus=t,e._selection=this,t._selection=this,this._cachedNodes=null,this.format=n,this.style=r,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!Jn(e)&&(this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style)}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(null!==e)return e;const t=this.anchor,n=this.focus,r=t.isBefore(n),i=r?t:n,s=r?n:t,o=i.getNode(),l=s.getNode();let c=o,a=l,u=!1;const f=new Set;if(Kr(o)&&(u=i.offset>0&&i.offset>=o.getChildrenSize(),c=o.getDescendantByIndex(i.offset)||o),Kr(l)){const e=l.getChildAtIndex(s.offset);if(e){f.add(e.getKey()),a=Kr(e)&&e.getFirstDescendant()||e;for(let t=a;t&&!t.is(e);t=t.getParent())f.add(t.getKey())}else{const e=s.offset>0&&l.getChildAtIndex(s.offset-1);if(e)a=Kr(e)&&e.getLastDescendant()||e;else{let e=l.getParent();for(;null!==e;e=e.getParent()){f.add(e.getKey());const t=e.getNextSibling();if(t){a=t;break}}l.isEmpty()&&l.is(a)||f.add(a.getKey())}}}let d;if(c.is(a)||this.isCollapsed())d=Kr(c)&&c.getChildrenSize()>0?[]:[c];else{if(d=c.getNodesBetween(a),f.size>0)for(;d.length>0&&f.has(d[d.length-1].getKey());)d.pop();if(u){const e=d.findIndex((e=>!e.is(c)&&!e.isBefore(c)));d.splice(0,e)}}return Sr()||(this._cachedNodes=d),d}setTextNodeRange(e,t,n,r){this.anchor.set(e.__key,t,"text"),this.focus.set(n.__key,r,"text")}getTextContent(){const e=this.getNodes();if(0===e.length)return"";const t=e[0],n=e[e.length-1],r=this.anchor,i=this.focus,s=r.isBefore(i),[o,l]=Vn(this);let c="",a=!0;for(let u=0;u<e.length;u++){const f=e[u];if(Kr(f)&&!f.isInline())a||(c+="\n"),a=!f.isEmpty();else if(a=!1,In(f)){let e=f.getTextContent();f===t?f===n?"element"===r.type&&"element"===i.type&&i.offset!==r.offset||(e=o<l?e.slice(o,l):e.slice(l,o)):e=s?e.slice(o):e.slice(l):f===n&&(e=s?e.slice(0,l):e.slice(0,o)),c+=e}else!jr(f)&&!pn(f)||f===n&&this.isCollapsed()||(c+=f.getTextContent())}return c}applyDOMRange(e){const t=br(),n=t.getEditorState()._selection,r=tr(e.startContainer,e.startOffset,e.endContainer,e.endOffset,t,n);if(null===r)return;const[i,s]=r;this.anchor.set(i.key,i.offset,i.type,!0),this.focus.set(s.key,s.offset,s.type,!0),ce(this)}clone(){const e=this.anchor,t=this.focus;return new jn(Wn(e.key,e.offset,e.type),Wn(t.key,t.offset,t.type),this.format,this.style)}toggleFormat(e){this.format=_i(this.format,e,null),this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const t=$[e];return!!(this.format&t)}insertRawText(e){const t=e.split(/(\r?\n|\t)/),n=[],r=t.length;for(let e=0;e<r;e++){const r=t[e];"\n"===r||"\r\n"===r?n.push(_n()):"\t"===r?n.push(Rn()):n.push(Pn(r))}this.insertNodes(n)}insertText(e){const n=this.anchor,r=this.focus,i=this.format,s=this.style;let o=n,l=r;!this.isCollapsed()&&r.isBefore(n)&&(o=r,l=n),"element"===o.type&&function(e,t,n,r){const i=e.getNode(),s=i.getChildAtIndex(e.offset),o=Pn(),l=Yr(i)?ti().append(o):o;o.setFormat(n),o.setStyle(r),null===s?i.append(l):s.insertBefore(l),e.is(t)&&t.set(o.__key,0,"text"),e.set(o.__key,0,"text")}(o,l,i,s),"element"===l.type&&no(l,ao(to(l,"next")));const c=o.offset;let a=l.offset;const u=this.getNodes(),f=u.length;let d=u[0];In(d)||t(26);const h=d.getTextContent().length,g=d.getParentOrThrow();let _=u[f-1];if(1===f&&"element"===l.type&&(a=h,l.set(o.key,a,"text")),this.isCollapsed()&&c===h&&(d.isSegmented()||d.isToken()||!d.canInsertTextAfter()||!g.canInsertTextAfter()&&null===d.getNextSibling())){let t=d.getNextSibling();if(In(t)&&t.canInsertTextBefore()&&!fi(t)||(t=Pn(),t.setFormat(i),t.setStyle(s),g.canInsertTextAfter()?d.insertAfter(t):g.insertAfter(t)),t.select(0,0),d=t,""!==e)return void this.insertText(e)}else if(this.isCollapsed()&&0===c&&(d.isSegmented()||d.isToken()||!d.canInsertTextBefore()||!g.canInsertTextBefore()&&null===d.getPreviousSibling())){let t=d.getPreviousSibling();if(In(t)&&!fi(t)||(t=Pn(),t.setFormat(i),g.canInsertTextBefore()?d.insertBefore(t):g.insertBefore(t)),t.select(),d=t,""!==e)return void this.insertText(e)}else if(d.isSegmented()&&c!==h){const e=Pn(d.getTextContent());e.setFormat(i),d.replace(e),d=e}else if(!this.isCollapsed()&&""!==e){const t=_.getParent();if(!g.canInsertTextBefore()||!g.canInsertTextAfter()||Kr(t)&&(!t.canInsertTextBefore()||!t.canInsertTextAfter()))return this.insertText(""),er(this.anchor,this.focus,null),void this.insertText(e)}if(1===f){if(d.isToken()){const t=Pn(e);return t.select(),void d.replace(t)}const t=d.getFormat(),n=d.getStyle();if(c!==a||t===i&&n===s){if(Bn(d)){const t=Pn(e);return t.setFormat(i),t.setStyle(s),t.select(),void d.replace(t)}}else{if(""!==d.getTextContent()){const t=Pn(e);if(t.setFormat(i),t.setStyle(s),t.select(),0===c)d.insertBefore(t,!1);else{const[e]=d.splitText(c);e.insertAfter(t,!1)}return void(t.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length))}d.setFormat(i),d.setStyle(s)}const r=a-c;d=d.spliceText(c,r,e,!0),""===d.getTextContent()?d.remove():"text"===this.anchor.type&&(d.isComposing()?this.anchor.offset-=e.length:(this.format=t,this.style=n))}else{const t=new Set([...d.getParentKeys(),..._.getParentKeys()]),n=Kr(d)?d:d.getParentOrThrow();let r=Kr(_)?_:_.getParentOrThrow(),i=_;if(!n.is(r)&&r.isInline())do{i=r,r=r.getParentOrThrow()}while(r.isInline());if("text"===l.type&&(0!==a||""===_.getTextContent())||"element"===l.type&&_.getIndexWithinParent()<a)if(In(_)&&!_.isToken()&&a!==_.getTextContentSize()){if(_.isSegmented()){const e=Pn(_.getTextContent());_.replace(e),_=e}Yr(l.getNode())||"text"!==l.type||(_=_.spliceText(0,a,"")),t.add(_.__key)}else{const e=_.getParentOrThrow();e.canBeEmpty()||1!==e.getChildrenSize()?_.remove():e.remove()}else t.add(_.__key);const s=r.getChildren(),o=new Set(u),g=n.is(r),p=n.isInline()&&null===d.getNextSibling()?n:d;for(let e=s.length-1;e>=0;e--){const t=s[e];if(t.is(d)||Kr(t)&&t.isParentOf(d))break;t.isAttached()&&(!o.has(t)||t.is(i)?g||p.insertAfter(t,!1):t.remove())}if(!g){let e=r,n=null;for(;null!==e;){const r=e.getChildren(),i=r.length;(0===i||r[i-1].is(n))&&(t.delete(e.__key),n=e),e=e.getParent()}}if(d.isToken())if(c===h)d.select();else{const t=Pn(e);t.select(),d.replace(t)}else d=d.spliceText(c,h-c,e,!0),""===d.getTextContent()?d.remove():d.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length);for(let e=1;e<f;e++){const n=u[e],r=n.__key;t.has(r)||n.remove()}}}removeText(){const e=or()===this;ro(this,co(io(this))),e&&or()!==this&&wi(this)}formatText(e,t=null){if(this.isCollapsed())return this.toggleFormat(e),void xi(null);const n=this.getNodes(),r=[];for(const e of n)In(e)&&r.push(e);const i=t=>{n.forEach((n=>{if(Kr(n)){const r=n.getFormatFlags(e,t);n.setTextFormat(r)}}))},s=r.length;if(0===s)return this.toggleFormat(e),xi(null),void i(t);const o=this.anchor,l=this.focus,c=this.isBackward(),a=c?l:o,u=c?o:l;let f=0,d=r[0],h="element"===a.type?0:a.offset;if("text"===a.type&&h===d.getTextContentSize()&&(f=1,d=r[1],h=0),null==d)return;const g=d.getFormatFlags(e,t);i(g);const _=s-1;let p=r[_];const m="text"===u.type?u.offset:p.getTextContentSize();if(d.is(p)){if(h===m)return;if(fi(d)||0===h&&m===d.getTextContentSize())d.setFormat(g);else{const e=d.splitText(h,m),t=0===h?e[0]:e[1];t.setFormat(g),"text"===a.type&&a.set(t.__key,0,"text"),"text"===u.type&&u.set(t.__key,m-h,"text")}return void(this.format=g)}0===h||fi(d)||([,d]=d.splitText(h),h=0),d.setFormat(g);const y=p.getFormatFlags(e,g);m>0&&(m===p.getTextContentSize()||fi(p)||([p]=p.splitText(m)),p.setFormat(y));for(let t=f+1;t<_;t++){const n=r[t],i=n.getFormatFlags(e,y);n.setFormat(i)}"text"===a.type&&a.set(d.__key,h,"text"),"text"===u.type&&u.set(p.__key,m,"text"),this.format=g|y}insertNodes(e){if(0===e.length)return;if(this.isCollapsed()||this.removeText(),"root"===this.anchor.key){this.insertParagraph();const n=or();return Jn(n)||t(134),n.insertNodes(e)}const n=(this.isBackward()?this.focus:this.anchor).getNode(),r=Ts(n,Ss),i=e[e.length-1];if(Kr(r)&&"__language"in r){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const t=hr(this);r.splice(t,0,e),i.selectEnd()}return}if(!e.some((e=>(Kr(e)||jr(e))&&!e.isInline()))){Kr(r)||t(211,n.constructor.name,n.getType());const s=hr(this);return r.splice(s,0,e),void i.selectEnd()}const s=function(e){const t=ti();let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=pn(i);if(s||jr(i)&&i.isInline()||Kr(i)&&i.isInline()||In(i)||i.isParentRequired()){if(null===n&&(n=i.createParentElementNode(),t.append(n),s))continue;null!==n&&n.append(i)}else t.append(i),n=null}return t}(e),o=s.getLastDescendant(),l=s.getChildren(),c=!Kr(r)||!r.isEmpty()?this.insertParagraph():null,a=l[l.length-1];let u=l[0];var f;Kr(f=u)&&Ss(f)&&!f.isEmpty()&&Kr(r)&&(!r.isEmpty()||r.canMergeWhenEmpty())&&(Kr(r)||t(211,n.constructor.name,n.getType()),r.append(...u.getChildren()),u=l[1]),u&&(null===r&&t(212,n.constructor.name,n.getType()),function(e,n,r){const i=n.getParentOrThrow().getLastChild();let s=n;const o=[n];for(;s!==i;)s.getNextSibling()||t(140),s=s.getNextSibling(),o.push(s);let l=e;for(const e of o)l=l.insertAfter(e)}(r,u));const d=Ts(o,Ss);c&&Kr(d)&&(c.canMergeWhenEmpty()||Ss(a))&&(d.append(...c.getChildren()),c.remove()),Kr(r)&&r.isEmpty()&&r.remove(),o.selectEnd();const h=Kr(r)?r.getLastChild():null;pn(h)&&d!==r&&h.remove()}insertParagraph(){if("root"===this.anchor.key){const e=ti();return Ei().splice(this.anchor.offset,0,[e]),e.select(),e}const e=hr(this),n=Ts(this.anchor.getNode(),Ss);Kr(n)||t(213);const r=n.getChildAtIndex(e),i=r?[r,...r.getNextSiblings()]:[],s=n.insertNewAfter(this,!1);return s?(s.append(...i),s.selectStart(),s):null}insertLineBreak(e){const t=_n();if(this.insertNodes([t]),e){const e=t.getParentOrThrow(),n=t.getIndexWithinParent();e.select(n,n)}}extract(){const e=this.getNodes(),t=e.length,n=t-1,r=this.anchor,i=this.focus;let s=e[0],o=e[n];const[l,c]=Vn(this);if(0===t)return[];if(1===t){if(In(s)&&!this.isCollapsed()){const e=l>c?c:l,t=l>c?l:c,n=s.splitText(e,t),r=0===e?n[0]:n[1];return null!=r?[r]:[]}return[s]}const a=r.isBefore(i);if(In(s)){const t=a?l:c;t===s.getTextContentSize()?e.shift():0!==t&&([,s]=s.splitText(t),e[0]=s)}if(In(o)){const t=o.getTextContent().length,r=a?c:l;0===r?e.pop():r!==t&&([o]=o.splitText(r),e[n]=o)}return e}modify(e,t,n){const r=this.focus,i=this.anchor,s="move"===e,o=Vi(r,t);if(jr(o)&&!o.isIsolated()){if(s&&o.isKeyboardSelectable()){const e=ir();return e.add(o.__key),void wi(e)}const e=t?o.getPreviousSibling():o.getNextSibling();if(In(e)){const n=e.__key,o=t?e.getTextContent().length:0;return r.set(n,o,"text"),void(s&&i.set(n,o,"text"))}{const n=o.getParentOrThrow();let l,c;return Kr(e)?(c=e.__key,l=t?e.getChildrenSize():0):(l=o.getIndexWithinParent(),c=n.__key,t||l++),r.set(c,l,"element"),void(s&&i.set(c,l,"element"))}}const l=br(),c=gs(ss(l));if(!c)return;const a=l._blockCursorElement,u=l._rootElement;if(null===u||null===a||!Kr(o)||o.isInline()||o.canBeEmpty()||hs(a,l,u),function(e,t,n,r){e.modify(t,n,r)}(c,e,t?"backward":"forward",n),c.rangeCount>0){const e=c.getRangeAt(0),n=this.anchor.getNode(),r=Yr(n)?n:os(n);if(this.applyDOMRange(e),this.dirty=!0,!s){const n=this.getNodes(),i=[];let s=!1;for(let e=0;e<n.length;e++){const t=n[e];rs(t,r)?i.push(t):s=!0}if(s&&i.length>0)if(t){const e=i[0];Kr(e)?e.selectStart():e.getParentOrThrow().selectStart()}else{const e=i[i.length-1];Kr(e)?e.selectEnd():e.getParentOrThrow().selectEnd()}c.anchorNode===e.startContainer&&c.anchorOffset===e.startOffset||function(e){const t=e.focus,n=e.anchor,r=n.key,i=n.offset,s=n.type;n.set(t.key,t.offset,t.type,!0),t.set(r,i,s,!0)}(this)}}}forwardDeletion(e,t,n){if(!n&&("element"===e.type&&Kr(t)&&e.offset===t.getChildrenSize()||"text"===e.type&&e.offset===t.getTextContentSize())){const e=t.getParent(),n=t.getNextSibling()||(null===e?null:e.getNextSibling());if(Kr(n)&&n.isShadowRoot())return!0}return!1}deleteCharacter(e){const t=this.isCollapsed();if(this.isCollapsed()){const t=this.anchor;let n=t.getNode();if(this.forwardDeletion(t,n,e))return;const r=Qs(to(t,e?"previous":"next"));if(r.getTextSlices().every((e=>null===e||0===e.distance))){let e={type:"initial"};for(const t of r.iterNodeCarets("shadowRoot"))if(zs(t))if(t.origin.isInline());else{if(t.origin.isShadowRoot()){if(Kr(r.anchor.origin)&&r.anchor.origin.isEmpty()){const e=ao(t);ro(this,Zs(e,e)),r.anchor.origin.remove()}return}if("merge-next-block"===e.type)return ro(this,Zs(!t.origin.isEmpty()&&e.block.isEmpty()?so(Us(e.block,t.direction)):r.anchor,t)),this.removeText()}else if(Bs(t)){if(Kr(t.origin)){if(t.origin.isInline()){if(!t.origin.isParentOf(r.anchor.origin))break}else e={block:t.origin,type:"merge-next-block"};continue}if(jr(t.origin)){if(t.origin.isIsolated());else if("merge-next-block"===e.type&&(t.origin.isKeyboardSelectable()||!t.origin.isInline())&&Kr(r.anchor.origin)&&r.anchor.origin.isEmpty()){r.anchor.origin.remove();const e=ir();e.add(t.origin.getKey()),wi(e)}else t.origin.remove();return}break}}const i=this.focus;if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&0===t.offset&&Gn(this,t.getNode()))return}else{const r="text"===i.type?i.getNode():null;if(n="text"===t.type?t.getNode():null,null!==r&&r.isSegmented()){const t=i.offset,s=r.getTextContentSize();if(r.is(n)||e&&t!==s||!e&&0!==t)return void Xn(r,e,t)}else if(null!==n&&n.isSegmented()){const i=t.offset,s=n.getTextContentSize();if(n.is(r)||e&&0!==i||!e&&i!==s)return void Xn(n,e,i)}!function(e,t){const n=e.anchor,r=e.focus,i=n.getNode(),s=r.getNode();if(i===s&&"text"===n.type&&"text"===r.type){const e=n.offset,s=r.offset,o=e<s,l=o?e:s,c=o?s:e,a=c-1;if(l!==a){(function(e){return!(Di(e)||qn(e))})(i.getTextContent().slice(l,c))&&(t?r.set(r.key,a,r.type):n.set(n.key,a,n.type))}}}(this,e)}}if(this.removeText(),e&&!t&&this.isCollapsed()&&"element"===this.anchor.type&&0===this.anchor.offset){const e=this.anchor.getNode();e.isEmpty()&&Yr(e.getParent())&&null===e.getPreviousSibling()&&Gn(this,e)}}deleteLine(e){if(this.isCollapsed()){const t="element"===this.anchor.type;if(t&&this.insertText(" "),this.modify("extend",e,"lineboundary"),this.isCollapsed()&&0===this.anchor.offset&&this.modify("extend",e,"character"),t){const t=e?this.anchor:this.focus;t.set(t.key,t.offset+1,t.type)}}this.removeText()}deleteWord(e){if(this.isCollapsed()){const t=this.anchor,n=t.getNode();if(this.forwardDeletion(t,n,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Hn(e){return e instanceof Un}function Yn(e){const t=e.offset;if("text"===e.type)return t;const n=e.getNode();return t===n.getChildrenSize()?n.getTextContent().length:0}function Vn(e){const t=e.getStartEndPoints();if(null===t)return[0,0];const[n,r]=t;return"element"===n.type&&"element"===r.type&&n.key===r.key&&n.offset===r.offset?[0,0]:[Yn(n),Yn(r)]}function Gn(e,t){for(let n=t;n;n=n.getParent()){if(Kr(n)){if(n.collapseAtStart(e))return!0;if(!n.isInline())break}if(n.getPreviousSibling())break}return!1}const qn=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("❤️")&&t("#️⃣")&&t("👍"))return t}catch(e){}return()=>!1})();function Xn(e,t,n){const r=e,i=r.getTextContent().split(/(?=\s)/g),s=i.length;let o=0,l=0;for(let e=0;e<s;e++){const r=e===s-1;if(l=o,o+=i[e].length,t&&o===n||o>n||r){i.splice(e,1),r&&(l=void 0);break}}const c=i.join("").trim();""===c?r.remove():(r.setTextContent(c),r.select(l,l))}function Qn(e,n,r,i){let s,o=n;if(ps(e)){let l=!1;const c=e.childNodes,a=c.length,u=i._blockCursorElement;o===a&&(l=!0,o=a-1);let f=c[o],d=!1;if(f===u)f=c[o+1],d=!0;else if(null!==u){const t=u.parentNode;if(e===t){n>Array.prototype.indexOf.call(t.children,u)&&o--}}if(s=Mi(f),In(s))o=Ai(s,l);else{let c=Mi(e);if(null===c)return null;if(Kr(c)){const a=i.getElementByKey(c.getKey());null===a&&t(214);const u=c.getDOMSlot(a);[c,o]=u.resolveChildIndex(c,a,e,n),Kr(c)||t(215),l&&o>=c.getChildrenSize()&&(o=Math.max(0,c.getChildrenSize()-1));let f=c.getChildAtIndex(o);if(Kr(f)&&function(e,t,n){const r=e.getParent();return null===n||null===r||!r.canBeEmpty()||r!==n.getNode()}(f,0,r)){const e=l?f.getLastDescendant():f.getFirstDescendant();null===e?c=f:(f=e,c=Kr(f)?f:f.getParentOrThrow()),o=0}In(f)?(s=f,c=null,o=Ai(f,l)):f!==c&&l&&!d&&(Kr(c)||t(216),o=Math.min(c.getChildrenSize(),o+1))}else{const t=c.getIndexWithinParent();o=0===n&&jr(c)&&Mi(e)===c?t:t+1,c=c.getParentOrThrow()}if(Kr(c))return Wn(c.__key,o,"element")}}else s=Mi(e);return In(s)?Wn(s.__key,o,"text"):null}function Zn(e,t,n){const r=e.offset,i=e.getNode();if(0===r){const r=i.getPreviousSibling(),s=i.getParent();if(t){if((n||!t)&&null===r&&Kr(s)&&s.isInline()){const t=s.getPreviousSibling();In(t)&&e.set(t.__key,t.getTextContent().length,"text")}}else Kr(r)&&!n&&r.isInline()?e.set(r.__key,r.getChildrenSize(),"element"):In(r)&&e.set(r.__key,r.getTextContent().length,"text")}else if(r===i.getTextContent().length){const r=i.getNextSibling(),s=i.getParent();if(t&&Kr(r)&&r.isInline())e.set(r.__key,0,"element");else if((n||t)&&null===r&&Kr(s)&&s.isInline()&&!s.canInsertTextAfter()){const t=s.getNextSibling();In(t)&&e.set(t.__key,0,"text")}}}function er(e,t,n){if("text"===e.type&&"text"===t.type){const r=e.isBefore(t),i=e.is(t);Zn(e,r,i),Zn(t,!r,i),i&&t.set(e.key,e.offset,e.type);const s=br();if(s.isComposing()&&s._compositionKey!==e.key&&Jn(n)){const r=n.anchor,i=n.focus;e.set(r.key,r.offset,r.type,!0),t.set(i.key,i.offset,i.type,!0)}}}function tr(e,t,n,r,i,s){if(null===e||null===n||!li(i,e,n))return null;const o=Qn(e,t,Jn(s)?s.anchor:null,i);if(null===o)return null;const l=Qn(n,r,Jn(s)?s.focus:null,i);if(null===l)return null;if("element"===o.type&&"element"===l.type){const t=Mi(e),r=Mi(n);if(jr(t)&&jr(r))return null}return er(o,l,s),[o,l]}function nr(e,t,n,r,i,s){const o=Nr(),l=new jn(Wn(e,t,i),Wn(n,r,s),0,"");return l.dirty=!0,o._selection=l,l}function rr(){const e=Wn("root",0,"element"),t=Wn("root",0,"element");return new jn(e,t,0,"")}function ir(){return new Un(new Set)}function sr(e,t,n,r){const i=n._window;if(null===i)return null;const s=r||i.event,o=s?s.type:void 0,l="selectionchange"===o,c=!G&&(l||"beforeinput"===o||"compositionstart"===o||"compositionend"===o||"click"===o&&s&&3===s.detail||"drop"===o||void 0===o);let a,u,f,d;if(Jn(e)&&!c)return e.clone();if(null===t)return null;if(a=t.anchorNode,u=t.focusNode,f=t.anchorOffset,d=t.focusOffset,l&&Jn(e)&&!li(n,a,u))return e.clone();const h=tr(a,f,u,d,n,e);if(null===h)return null;const[g,_]=h;return new jn(g,_,Jn(e)?e.format:0,Jn(e)?e.style:"")}function or(){return Nr()._selection}function lr(){return br()._editorState._selection}function cr(e,t,n,r=1){const i=e.anchor,s=e.focus,o=i.getNode(),l=s.getNode();if(!t.is(o)&&!t.is(l))return;const c=t.__key;if(e.isCollapsed()){const t=i.offset;if(n<=t&&r>0||n<t&&r<0){const n=Math.max(0,t+r);i.set(c,n,"element"),s.set(c,n,"element"),ar(e)}}else{const o=e.isBackward(),l=o?s:i,a=l.getNode(),u=o?i:s,f=u.getNode();if(t.is(a)){const e=l.offset;(n<=e&&r>0||n<e&&r<0)&&l.set(c,Math.max(0,e+r),"element")}if(t.is(f)){const e=u.offset;(n<=e&&r>0||n<e&&r<0)&&u.set(c,Math.max(0,e+r),"element")}}ar(e)}function ar(e){const t=e.anchor,n=t.offset,r=e.focus,i=r.offset,s=t.getNode(),o=r.getNode();if(e.isCollapsed()){if(!Kr(s))return;const e=s.getChildrenSize(),i=n>=e,o=i?s.getChildAtIndex(e-1):s.getChildAtIndex(n);if(In(o)){let e=0;i&&(e=o.getTextContentSize()),t.set(o.__key,e,"text"),r.set(o.__key,e,"text")}}else{if(Kr(s)){const e=s.getChildrenSize(),r=n>=e,i=r?s.getChildAtIndex(e-1):s.getChildAtIndex(n);if(In(i)){let e=0;r&&(e=i.getTextContentSize()),t.set(i.__key,e,"text")}}if(Kr(o)){const e=o.getChildrenSize(),t=i>=e,n=t?o.getChildAtIndex(e-1):o.getChildAtIndex(i);if(In(n)){let e=0;t&&(e=n.getTextContentSize()),r.set(n.__key,e,"text")}}}}function ur(e,t,n,r,i){let s=null,o=0,l=null;null!==r?(s=r.__key,In(r)?(o=r.getTextContentSize(),l="text"):Kr(r)&&(o=r.getChildrenSize(),l="element")):null!==i&&(s=i.__key,In(i)?l="text":Kr(i)&&(l="element")),null!==s&&null!==l?e.set(s,o,l):(o=t.getIndexWithinParent(),-1===o&&(o=n.getChildrenSize()),e.set(n.__key,o,"element"))}function fr(e,t,n,r,i){"text"===e.type?e.set(n,e.offset+(t?0:i),"text"):e.offset>r.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function dr(e,t,n,r,i,s,o){const l=r.anchorNode,c=r.focusNode,a=r.anchorOffset,u=r.focusOffset,f=document.activeElement;if(i.has("collaboration")&&f!==s||null!==f&&oi(f))return;if(!Jn(t))return void(null!==e&&li(n,l,c)&&r.removeAllRanges());const d=t.anchor,h=t.focus,g=d.key,_=h.key,p=Qi(n,g),m=Qi(n,_),y=d.offset,x=h.offset,C=t.format,S=t.style,T=t.isCollapsed();let v=p,N=m,b=!1;if("text"===d.type){v=gi(p);const e=d.getNode();b=e.getFormat()!==C||e.getStyle()!==S}else Jn(e)&&"text"===e.anchor.type&&(b=!0);var k,E,O,w,M;if(("text"===h.type&&(N=gi(m)),null!==v&&null!==N)&&(T&&(null===e||b||Jn(e)&&(e.format!==C||e.style!==S))&&(k=C,E=S,O=y,w=g,M=performance.now(),Qt=[k,E,O,w,M]),a!==y||u!==x||l!==v||c!==N||"Range"===r.type&&T||(null!==f&&s.contains(f)||s.focus({preventScroll:!0}),"element"===d.type))){try{r.setBaseAndExtent(v,y,N,x)}catch(e){}if(!i.has("skip-scroll-into-view")&&t.isCollapsed()&&null!==s&&s===document.activeElement){const e=Jn(t)&&"element"===t.anchor.type?v.childNodes[y]||null:r.rangeCount>0?r.getRangeAt(0):null;if(null!==e){let t;if(e instanceof Text){const n=document.createRange();n.selectNode(e),t=n.getBoundingClientRect()}else t=e.getBoundingClientRect();!function(e,t,n){const r=es(n),i=is(r);if(null===r||null===i)return;let{top:s,bottom:o}=t,l=0,c=0,a=n;for(;null!==a;){const t=a===r.body;if(t)l=0,c=ss(e).innerHeight;else{const e=a.getBoundingClientRect();l=e.top,c=e.bottom}let n=0;if(s<l?n=-(l-s):o>c&&(n=o-c),0!==n)if(t)i.scrollBy(0,n);else{const e=a.scrollTop;a.scrollTop+=n;const t=a.scrollTop-e;s-=t,o-=t}if(t)break;a=Zi(a)}}(n,t,s)}}Ht=!0}}function hr(e){let n=e;e.isCollapsed()||n.removeText();const r=or();Jn(r)&&(n=r),Jn(n)||t(161);const i=n.anchor;let s=i.getNode(),o=i.offset;for(;!Ss(s);){const e=s;if([s,o]=gr(s,o),e.is(s))break}return o}function gr(e,t){const n=e.getParent();if(!n){const e=ti();return Ei().append(e),e.select(),[Ei(),0]}if(In(e)){const r=e.splitText(t);if(0===r.length)return[n,e.getIndexWithinParent()];const i=0===t?0:1;return[n,r[0].getIndexWithinParent()+i]}if(!Kr(e)||0===t)return[n,e.getIndexWithinParent()];const r=e.getChildAtIndex(t);if(r){const n=new jn(Wn(e.__key,t,"element"),Wn(e.__key,t,"element"),0,""),i=e.insertNewAfter(n);i&&i.append(r,...r.getNextSiblings())}return[n,e.getIndexWithinParent()+1]}let _r=null,pr=null,mr=!1,yr=!1,xr=0;const Cr={characterData:!0,childList:!0,subtree:!0};function Sr(){return mr||null!==_r&&_r._readOnly}function Tr(){mr&&t(13)}function vr(){xr>99&&t(14)}function Nr(){return null===_r&&t(195,kr()),_r}function br(){return null===pr&&t(196,kr()),pr}function kr(){let e=0;const t=new Set,n=ri.version;if("undefined"!=typeof window)for(const r of document.querySelectorAll("[contenteditable]")){const i=ui(r);if(ci(i))e++;else if(i){let e=String(i.constructor.version||"<0.17.1");e===n&&(e+=" (separately built, likely a bundler configuration issue)"),t.add(e)}}let r=` Detected on the page: ${e} compatible editor(s) with version ${n}`;return t.size&&(r+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),r}function Er(){return pr}function Or(e,n,r){const i=n.__type,s=function(e,n){const r=e._nodes.get(n);void 0===r&&t(30,n);return r}(e,i);let o=r.get(i);void 0===o&&(o=Array.from(s.transforms),r.set(i,o));const l=o.length;for(let e=0;e<l&&(o[e](n),n.isAttached());e++);}function wr(e,t){return void 0!==e&&e.__key!==t&&e.isAttached()}function Mr(e,t){if(!t)return;const n=e._updateTags;let r=t;Array.isArray(t)||(r=[t]);for(const e of r)n.add(e)}function Ar(e,n){const r=e.type,i=n.get(r);void 0===i&&t(17,r);const s=i.klass;e.type!==s.getType()&&t(18,s.name);const o=s.importJSON(e),l=e.children;if(Kr(o)&&Array.isArray(l))for(let e=0;e<l.length;e++){const t=Ar(l[e],n);o.append(t)}return o}function Dr(e,t,n){const r=_r,i=mr,s=pr;_r=t,mr=!0,pr=e;try{return n()}finally{_r=r,mr=i,pr=s}}function Pr(e,t){const n=e._pendingEditorState,r=e._rootElement,i=e._headless||null===r;if(null===n)return;const s=e._editorState,o=s._selection,l=n._selection,c=e._dirtyType!==y,a=_r,u=mr,f=pr,d=e._updating,g=e._observer;let _=null;if(e._pendingEditorState=null,e._editorState=n,!i&&c&&null!==g){pr=e,_r=n,mr=!1,e._updating=!0;try{const t=e._dirtyType,r=e._dirtyElements,i=e._dirtyLeaves;g.disconnect(),_=Je(s,n,e,t,r,i)}catch(t){if(t instanceof Error&&e._onError(t),yr)throw t;return ni(e,null,r,n),ie(e),e._dirtyType=C,yr=!0,Pr(e,s),void(yr=!1)}finally{g.observe(r,Cr),e._updating=d,_r=a,mr=u,pr=f}}n._readOnly||(n._readOnly=!0);const p=e._dirtyLeaves,m=e._dirtyElements,x=e._normalizedNodes,S=e._updateTags,T=e._deferred;c&&(e._dirtyType=y,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),function(e,t){const n=e._decorators;let r=e._pendingDecorators||n;const i=t._nodeMap;let s;for(s in r)i.has(s)||(r===n&&(r=bi(e)),delete r[s])}(e,n);const v=i?null:gs(ss(e));if(e._editable&&null!==v&&(c||null===l||l.dirty)&&null!==r&&!S.has("skip-dom-selection")){pr=e,_r=n;try{if(null!==g&&g.disconnect(),c||null===l||l.dirty){const t=e._blockCursorElement;null!==t&&hs(t,e,r),dr(o,l,e,v,S,r)}!function(e,t,n){let r=e._blockCursorElement;if(Jn(n)&&n.isCollapsed()&&"element"===n.anchor.type&&t.contains(document.activeElement)){const i=n.anchor,s=i.getNode(),o=i.offset;let l=!1,c=null;if(o===s.getChildrenSize()){ds(s.getChildAtIndex(o-1))&&(l=!0)}else{const t=s.getChildAtIndex(o);if(null!==t&&ds(t)){const n=t.getPreviousSibling();(null===n||ds(n))&&(l=!0,c=e.getElementByKey(t.__key))}}if(l){const n=e.getElementByKey(s.__key);return null===r&&(e._blockCursorElement=r=function(e){const t=e.theme,n=document.createElement("div");n.contentEditable="false",n.setAttribute("data-lexical-cursor","true");let r=t.blockCursor;if(void 0!==r){if("string"==typeof r){const e=h(r);r=t.blockCursor=e}void 0!==r&&n.classList.add(...r)}return n}(e._config)),t.style.caretColor="transparent",void(null===c?n.appendChild(r):n.insertBefore(r,c))}}null!==r&&hs(r,e,t)}(e,r,l)}finally{null!==g&&g.observe(r,Cr),pr=f,_r=a}}null!==_&&function(e,t,n,r,i){const s=Array.from(e._listeners.mutation),o=s.length;for(let e=0;e<o;e++){const[o,l]=s[e],c=t.get(l);void 0!==c&&o(c,{dirtyLeaves:r,prevEditorState:i,updateTags:n})}}(e,_,S,p,s),Jn(l)||null===l||null!==o&&o.is(l)||e.dispatchCommand(Ye,void 0);const N=e._pendingDecorators;null!==N&&(e._decorators=N,e._pendingDecorators=null,Ir("decorator",e,!0,N)),function(e,t,n){const r=ki(t),i=ki(n);r!==i&&Ir("textcontent",e,!0,i)}(e,t||s,n),Ir("update",e,!0,{dirtyElements:m,dirtyLeaves:p,editorState:n,normalizedNodes:x,prevEditorState:t||s,tags:S}),function(e,t){if(e._deferred=[],0!==t.length){const n=e._updating;e._updating=!0;try{for(let e=0;e<t.length;e++)t[e]()}finally{e._updating=n}}}(e,T),function(e){const t=e._updates;if(0!==t.length){const n=t.shift();if(n){const[t,r]=n;Rr(e,t,r)}}}(e)}function Ir(e,t,n,...r){const i=t._updating;t._updating=n;try{const n=Array.from(t._listeners[e]);for(let e=0;e<n.length;e++)n[e].apply(null,r)}finally{t._updating=i}}function Lr(e,t,n){if(!1===e._updating||pr!==e){let r=!1;return e.update((()=>{r=Lr(e,t,n)})),r}const r=Pi(e);for(let i=4;i>=0;i--)for(let s=0;s<r.length;s++){const o=r[s]._commands.get(t);if(void 0!==o){const t=o[i];if(void 0!==t){const r=Array.from(t),i=r.length;for(let t=0;t<i;t++)if(!0===r[t](n,e))return!0}}}return!1}function Fr(e,n){const r=e._updates;let i=n||!1;for(;0!==r.length;){const n=r.shift();if(n){const[r,s]=n;let o;if(void 0!==s){if(o=s.onUpdate,s.skipTransforms&&(i=!0),s.discrete){const n=e._pendingEditorState;null===n&&t(191),n._flushSync=!0}o&&e._deferred.push(o),Mr(e,s.tag)}r()}}return i}function Rr(e,n,r){const i=e._updateTags;let s,o=!1,l=!1;void 0!==r&&(s=r.onUpdate,Mr(e,r.tag),o=r.skipTransforms||!1,l=r.discrete||!1),s&&e._deferred.push(s);const c=e._editorState;let a=e._pendingEditorState,u=!1;(null===a||a._readOnly)&&(a=e._pendingEditorState=Vr(a||c),u=!0),a._flushSync=l;const f=_r,d=mr,h=pr,g=e._updating;_r=a,mr=!1,e._updating=!0,pr=e;const _=e._headless||null===e.getRootElement();try{u&&(_?null!==c._selection&&(a._selection=c._selection.clone()):a._selection=function(e,t){const n=e.getEditorState()._selection,r=gs(ss(e));return Jn(n)||null==n?sr(n,r,e,t):n.clone()}(e,r&&r.event||null));const i=e._compositionKey;n(),o=Fr(e,o),function(e,t){const n=t.getEditorState()._selection,r=e._selection;if(Jn(r)){const e=r.anchor,t=r.focus;let i;if("text"===e.type&&(i=e.getNode(),i.selectionTransform(n,r)),"text"===t.type){const e=t.getNode();i!==e&&e.selectionTransform(n,r)}}}(a,e),e._dirtyType!==y&&(o?function(e,t){const n=t._dirtyLeaves,r=e._nodeMap;for(const e of n){const t=r.get(e);In(t)&&t.isAttached()&&t.isSimpleText()&&!t.isUnmergeable()&&le(t)}}(a,e):function(e,t){const n=t._dirtyLeaves,r=t._dirtyElements,i=e._nodeMap,s=Ci(),o=new Map;let l=n,c=l.size,a=r,u=a.size;for(;c>0||u>0;){if(c>0){t._dirtyLeaves=new Set;for(const e of l){const r=i.get(e);In(r)&&r.isAttached()&&r.isSimpleText()&&!r.isUnmergeable()&&le(r),void 0!==r&&wr(r,s)&&Or(t,r,o),n.add(e)}if(l=t._dirtyLeaves,c=l.size,c>0){xr++;continue}}t._dirtyLeaves=new Set,t._dirtyElements=new Map;for(const e of a){const n=e[0],l=e[1];if("root"!==n&&!l)continue;const c=i.get(n);void 0!==c&&wr(c,s)&&Or(t,c,o),r.set(n,l)}l=t._dirtyLeaves,c=l.size,a=t._dirtyElements,u=a.size,xr++}t._dirtyLeaves=n,t._dirtyElements=r}(a,e),Fr(e),function(e,t,n,r){const i=e._nodeMap,s=t._nodeMap,o=[];for(const[e]of r){const t=s.get(e);void 0!==t&&(t.isAttached()||(Kr(t)&&Y(t,e,i,s,o,r),i.has(e)||r.delete(e),o.push(e)))}for(const e of o)s.delete(e);for(const e of n){const t=s.get(e);void 0===t||t.isAttached()||(i.has(e)||n.delete(e),s.delete(e))}}(c,a,e._dirtyLeaves,e._dirtyElements));i!==e._compositionKey&&(a._flushSync=!0);const s=a._selection;if(Jn(s)){const e=a._nodeMap,n=s.anchor.key,r=s.focus.key;void 0!==e.get(n)&&void 0!==e.get(r)||t(19)}else Hn(s)&&0===s._nodes.size&&(a._selection=null)}catch(t){return t instanceof Error&&e._onError(t),e._pendingEditorState=c,e._dirtyType=C,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Pr(e)}finally{_r=f,mr=d,pr=h,e._updating=g,xr=0}const p=e._dirtyType!==y||e._deferred.length>0||function(e,t){const n=t.getEditorState()._selection,r=e._selection;if(null!==r){if(r.dirty||!r.is(n))return!0}else if(null!==n)return!0;return!1}(a,e);p?a._flushSync?(a._flushSync=!1,Pr(e)):u&&si((()=>{Pr(e)})):(a._flushSync=!1,u&&(i.clear(),e._deferred=[],e._pendingEditorState=null))}function Br(e,t,n){e._updating?pr===e?t():e._updates.push([t,n]):Rr(e,t,n)}class zr{constructor(e,t,n){this.element=e,this.before=t||null,this.after=n||null}withBefore(e){return new zr(this.element,e,this.after)}withAfter(e){return new zr(this.element,this.before,e)}withElement(e){return new zr(e,this.before,this.after)}insertChild(e){const n=this.before||this.getManagedLineBreak();return null!==n&&n.parentElement!==this.element&&t(222),this.element.insertBefore(e,n),this}removeChild(e){return e.parentElement!==this.element&&t(223),this.element.removeChild(e),this}replaceChild(e,n){return n.parentElement!==this.element&&t(224),this.element.replaceChild(e,n),this}getFirstChild(){const e=this.after?this.after.nextSibling:this.element.firstChild;return e===this.before||e===this.getManagedLineBreak()?null:e}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(e){if(null===e)this.removeManagedLineBreak();else{const t="decorator"===e&&(c||l);this.insertManagedLineBreak(t)}}removeManagedLineBreak(){const e=this.getManagedLineBreak();if(e){const t=this.element,n="IMG"===e.nodeName?e.nextSibling:null;n&&t.removeChild(n),t.removeChild(e),t.__lexicalLineBreak=void 0}}insertManagedLineBreak(e){const t=this.getManagedLineBreak();if(t){if(e===("IMG"===t.nodeName))return;this.removeManagedLineBreak()}const n=this.element,r=this.before,i=document.createElement("br");if(n.insertBefore(i,r),e){const e=document.createElement("img");e.setAttribute("data-lexical-linebreak","true"),e.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",e.alt="",n.insertBefore(e,i),n.__lexicalLineBreak=e}else n.__lexicalLineBreak=i}getFirstChildOffset(){let e=0;for(let t=this.after;null!==t;t=t.previousSibling)e++;return e}resolveChildIndex(e,t,n,r){if(n===this.element){const t=this.getFirstChildOffset();return[e,Math.min(t+e.getChildrenSize(),Math.max(t,r))]}const i=Wr(t,n);i.push(r);const s=Wr(t,this.element);let o=e.getIndexWithinParent();for(let e=0;e<s.length;e++){const t=i[e],n=s[e];if(void 0===t||t<n)break;if(t>n){o+=1;break}}return[e.getParentOrThrow(),o]}}function Wr(e,n){const r=[];let i=n;for(;i!==e&&null!==i;i=n.parentNode){let e=0;for(let t=i.previousSibling;null!==t;t=t.previousSibling)e++;r.push(e)}return i!==e&&t(225),r.reverse()}class $r extends dn{constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(e){super.afterCloneFrom(e),this.__first=e.__first,this.__last=e.__last,this.__size=e.__size,this.__indent=e.__indent,this.__format=e.__format,this.__style=e.__style,this.__dir=e.__dir,this.__textFormat=e.__textFormat,this.__textStyle=e.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return J[e]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let t=this.getFirstChild();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getChildrenKeys(){const e=[];let t=this.getFirstChild();for(;null!==t;)e.push(t.__key),t=t.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return 0===this.getChildrenSize()}isDirty(){const e=br()._dirtyElements;return null!==e&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),t=this.getParentOrThrow().getLastChild();return null!==t&&t.is(e)}getAllTextNodes(){const e=[];let t=this.getFirstChild();for(;null!==t;){if(In(t)&&e.push(t),Kr(t)){const n=t.getAllTextNodes();e.push(...n)}t=t.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;Kr(e);){const t=e.getFirstChild();if(null===t)break;e=t}return e}getLastDescendant(){let e=this.getLastChild();for(;Kr(e);){const t=e.getLastChild();if(null===t)break;e=t}return e}getDescendantByIndex(e){const t=this.getChildren(),n=t.length;if(e>=n){const e=t[n-1];return Kr(e)&&e.getLastDescendant()||e||null}const r=t[e];return Kr(r)&&r.getFirstDescendant()||r||null}getFirstChild(){const e=this.getLatest().__first;return null===e?null:Si(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return null===e&&t(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return null===e?null:Si(e)}getLastChildOrThrow(){const e=this.getLastChild();return null===e&&t(96,this.__key),e}getChildAtIndex(e){const t=this.getChildrenSize();let n,r;if(e<t/2){for(n=this.getFirstChild(),r=0;null!==n&&r<=e;){if(r===e)return n;n=n.getNextSibling(),r++}return null}for(n=this.getLastChild(),r=t-1;null!==n&&r>=e;){if(r===e)return n;n=n.getPreviousSibling(),r--}return null}getTextContent(){let e="";const t=this.getChildren(),n=t.length;for(let r=0;r<n;r++){const i=t[r];e+=i.getTextContent(),Kr(i)&&r!==n-1&&!i.isInline()&&(e+=L)}return e}getTextContentSize(){let e=0;const t=this.getChildren(),n=t.length;for(let r=0;r<n;r++){const i=t[r];e+=i.getTextContentSize(),Kr(i)&&r!==n-1&&!i.isInline()&&(e+=L.length)}return e}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(e){if(""!==e){const t=U[e];return!!(this.getFormat()&t)}return!1}hasTextFormat(e){const t=$[e];return!!(this.getTextFormat()&t)}getFormatFlags(e,t){return _i(this.getLatest().__textFormat,e,t)}getTextStyle(){return this.getLatest().__textStyle}select(e,t){Tr();const n=or();let r=e,i=t;const s=this.getChildrenSize();if(!this.canBeEmpty())if(0===e&&0===t){const e=this.getFirstChild();if(In(e)||Kr(e))return e.select(0,0)}else if(!(void 0!==e&&e!==s||void 0!==t&&t!==s)){const e=this.getLastChild();if(In(e)||Kr(e))return e.select()}void 0===r&&(r=s),void 0===i&&(i=s);const o=this.__key;return Jn(n)?(n.anchor.set(o,r,"element"),n.focus.set(o,i,"element"),n.dirty=!0,n):nr(o,r,o,i,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach((e=>e.remove())),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const t=this.getWritable();return t.__dir=e,t}setFormat(e){return this.getWritable().__format=""!==e?U[e]:0,this}setStyle(e){return this.getWritable().__style=e||"",this}setTextFormat(e){const t=this.getWritable();return t.__textFormat=e,t}setTextStyle(e){const t=this.getWritable();return t.__textStyle=e,t}setIndent(e){return this.getWritable().__indent=e,this}splice(e,n,r){const i=r.length,s=this.getChildrenSize(),o=this.getWritable();e+n<=s||t(226,String(e),String(n),String(s));const l=o.__key,c=[],a=[],u=this.getChildAtIndex(e+n);let f=null,d=s-n+i;if(0!==e)if(e===s)f=this.getLastChild();else{const t=this.getChildAtIndex(e);null!==t&&(f=t.getPreviousSibling())}if(n>0){let e=null===f?this.getFirstChild():f.getNextSibling();for(let r=0;r<n;r++){null===e&&t(100);const n=e.getNextSibling(),r=e.__key;mi(e.getWritable()),a.push(r),e=n}}let h=f;for(let e=0;e<i;e++){const n=r[e];null!==h&&n.is(h)&&(f=h=h.getPreviousSibling());const i=n.getWritable();i.__parent===l&&d--,mi(i);const s=n.__key;if(null===h)o.__first=s,i.__prev=null;else{const e=h.getWritable();e.__next=s,i.__prev=e.__key}n.__key===l&&t(76),i.__parent=l,c.push(s),h=n}if(e+n===s){if(null!==h){h.getWritable().__next=null,o.__last=h.__key}}else if(null!==u){const e=u.getWritable();if(null!==h){const t=h.getWritable();e.__prev=h.__key,t.__next=u.__key}else e.__prev=null}if(o.__size=d,a.length){const e=or();if(Jn(e)){const t=new Set(a),n=new Set(c),{anchor:r,focus:i}=e;Ur(r,t,n)&&ur(r,r.getNode(),this,f,u),Ur(i,t,n)&&ur(i,i.getNode(),this,f,u),0!==d||this.canBeEmpty()||ls(this)||this.remove()}}return o}getDOMSlot(e){return new zr(e)}exportDOM(e){const{element:t}=super.exportDOM(e);if(ps(t)){const e=this.getIndent();e>0&&(t.style.paddingInlineStart=40*e+"px")}return{element:t}}exportJSON(){const e={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},t=this.getTextFormat(),n=this.getTextStyle();return 0!==t&&(e.textFormat=t),""!==n&&(e.textStyle=n),e}updateFromJSON(e){return super.updateFromJSON(e).setFormat(e.format).setIndent(e.indent).setDirection(e.direction).setTextFormat(e.textFormat||0).setTextStyle(e.textStyle||"")}insertNewAfter(e,t){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,t,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(e,t){const n=this.getDOMSlot(e);let r=n.getFirstChild();for(let e=this.getFirstChild();e;e=e.getNextSibling()){const i=t.getElementByKey(e.getKey());null!==i&&(null==r?(n.insertChild(i),r=i):r!==i&&n.replaceChild(i,r),r=r.nextSibling)}}}function Kr(e){return e instanceof $r}function Ur(e,t,n){let r=e.getNode();for(;r;){const e=r.__key;if(t.has(e)&&!n.has(e))return!0;r=r.getParent()}return!1}class Jr extends dn{decorate(e,n){t(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function jr(e){return e instanceof Jr}class Hr extends $r{static getType(){return"root"}static clone(){return new Hr}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){t(51)}getTextContent(){const e=this.__cachedText;return!Sr()&&br()._dirtyType!==y||null===e?super.getTextContent():e}remove(){t(52)}replace(e){t(53)}insertBefore(e){t(54)}insertAfter(e){t(55)}updateDOM(e,t){return!1}append(...e){for(let n=0;n<e.length;n++){const r=e[n];Kr(r)||jr(r)||t(56)}return super.append(...e)}static importJSON(e){return Ei().updateFromJSON(e)}collapseAtStart(){return!0}}function Yr(e){return e instanceof Hr}function Vr(e){return new Xr(new Map(e._nodeMap))}function Gr(){return new Xr(new Map([["root",new Hr]]))}function qr(e){const n=e.exportJSON(),r=e.constructor;if(n.type!==r.getType()&&t(130,r.name),Kr(e)){const i=n.children;Array.isArray(i)||t(59,r.name);const s=e.getChildren();for(let e=0;e<s.length;e++){const t=qr(s[e]);i.push(t)}}return n}class Xr{constructor(e,t){this._nodeMap=e,this._selection=t||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return 1===this._nodeMap.size&&null===this._selection}read(e,t){return Dr(t&&t.editor||null,this,e)}clone(e){const t=new Xr(this._nodeMap,void 0===e?this._selection:e);return t._readOnly=!0,t}toJSON(){return Dr(null,this,(()=>({root:qr(Ei())})))}}class Qr extends $r{static getType(){return"artificial"}createDOM(e){return document.createElement("div")}}class Zr extends $r{static getType(){return"paragraph"}static clone(e){return new Zr(e.__key)}createDOM(e){const t=document.createElement("p"),n=ji(e.theme,"paragraph");if(void 0!==n){t.classList.add(...n)}return t}updateDOM(e,t,n){return!1}static importDOM(){return{p:e=>({conversion:ei,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(ps(t)){this.isEmpty()&&t.append(document.createElement("br"));const e=this.getFormatType();t.style.textAlign=e;const n=this.getDirection();n&&(t.dir=n)}return{element:t}}static importJSON(e){return ti().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(e,t){const n=ti();n.setTextFormat(e.format),n.setTextStyle(e.style);const r=this.getDirection();return n.setDirection(r),n.setFormat(this.getFormatType()),n.setStyle(this.getTextStyle()),this.insertAfter(n,t),n}collapseAtStart(){const e=this.getChildren();if(0===e.length||In(e[0])&&""===e[0].getTextContent().trim()){if(null!==this.getNextSibling())return this.selectNext(),this.remove(),!0;if(null!==this.getPreviousSibling())return this.selectPrevious(),this.remove(),!0}return!1}}function ei(e){const t=ti();return e.style&&(t.setFormat(e.style.textAlign),Es(e,t)),{node:t}}function ti(){return as(new Zr)}function ni(e,t,n,r){const i=e._keyToDOMMap;i.clear(),e._editorState=Gr(),e._pendingEditorState=r,e._compositionKey=null,e._dirtyType=y,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const s=e._observer;null!==s&&(s.disconnect(),e._observer=null),null!==t&&(t.textContent=""),null!==n&&(n.textContent="",i.set("root",n))}class ri{constructor(e,t,n,r,i,s,o){this._parentEditor=t,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=r,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=y,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=Ii(),this._onError=i,this._htmlConversions=s,this._editable=o,this._headless=null!==t&&t._headless,this._window=null,this._blockCursorElement=null}isComposing(){return null!=this._compositionKey}registerUpdateListener(e){const t=this._listeners.update;return t.add(e),()=>{t.delete(e)}}registerEditableListener(e){const t=this._listeners.editable;return t.add(e),()=>{t.delete(e)}}registerDecoratorListener(e){const t=this._listeners.decorator;return t.add(e),()=>{t.delete(e)}}registerTextContentListener(e){const t=this._listeners.textcontent;return t.add(e),()=>{t.delete(e)}}registerRootListener(e){const t=this._listeners.root;return e(this._rootElement,null),t.add(e),()=>{e(null,this._rootElement),t.delete(e)}}registerCommand(e,n,r){void 0===r&&t(35);const i=this._commands;i.has(e)||i.set(e,[new Set,new Set,new Set,new Set,new Set]);const s=i.get(e);void 0===s&&t(36,String(e));const o=s[r];return o.add(n),()=>{o.delete(n),s.every((e=>0===e.size))&&i.delete(e)}}registerMutationListener(e,t,n){const r=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass,i=this._listeners.mutation;i.set(t,r);const s=n&&n.skipInitialization;return void 0!==s&&s||this.initializeMutationListener(t,r),()=>{i.delete(t)}}getRegisteredNode(e){const n=this._nodes.get(e.getType());return void 0===n&&t(37,e.name),n}resolveRegisteredNodeAfterReplacements(e){for(;e.replaceWithKlass;)e=this.getRegisteredNode(e.replaceWithKlass);return e}initializeMutationListener(e,t){const n=this._editorState,r=bs(n).get(t.getType());if(!r)return;const i=new Map;for(const e of r.keys())i.set(e,"created");i.size>0&&e(i,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(e,t){const n=this.getRegisteredNode(e);return n.transforms.add(t),n}registerNodeTransform(e,t){const n=this.registerNodeTransformToKlass(e,t),r=[n],i=n.replaceWithKlass;if(null!=i){const e=this.registerNodeTransformToKlass(i,t);r.push(e)}return function(e,t){const n=bs(e.getEditorState()),r=[];for(const e of t){const t=n.get(e);t&&r.push(t)}if(0===r.length)return;e.update((()=>{for(const e of r)for(const t of e.keys()){const e=Si(t);e&&e.markDirty()}}),null===e._pendingEditorState?{tag:"history-merge"}:void 0)}(this,r.map((e=>e.klass.getType()))),()=>{r.forEach((e=>e.transforms.delete(t)))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,t){return qi(this,e,t)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const t=this._rootElement;if(e!==t){const n=ji(this._config.theme,"root"),r=this._pendingEditorState||this._editorState;if(this._rootElement=e,ni(this,t,e,r),null!==t&&(this._config.disableEvents||un(t),null!=n&&t.classList.remove(...n)),null!==e){const t=is(e),r=e.style;r.userSelect="text",r.whiteSpace="pre-wrap",r.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=t,this._dirtyType=C,ie(this),this._updateTags.add("history-merge"),Pr(this),this._config.disableEvents||function(e,t){const n=e.ownerDocument,r=jt.get(n);(void 0===r||r<1)&&n.addEventListener("selectionchange",ln),jt.set(n,(r||0)+1),e.__lexicalEditor=t;const i=sn(e);for(let n=0;n<Wt.length;n++){const[r,s]=Wt[n],o="function"==typeof s?e=>{an(e)||(cn(e),(t.isEditable()||"click"===r)&&s(e,t))}:e=>{if(an(e))return;cn(e);const n=t.isEditable();switch(r){case"cut":return n&&qi(t,wt,e);case"copy":return qi(t,Ot,e);case"paste":return n&&qi(t,et,e);case"dragstart":return n&&qi(t,bt,e);case"dragover":return n&&qi(t,kt,e);case"dragend":return n&&qi(t,Et,e);case"focus":return n&&qi(t,Lt,e);case"blur":return n&&qi(t,Ft,e);case"drop":return n&&qi(t,vt,e)}};e.addEventListener(r,o),i.push((()=>{e.removeEventListener(r,o)}))}}(e,this),null!=n&&e.classList.add(...n)}else this._window=null,this._updateTags.add("history-merge"),Pr(this);Ir("root",this,!1,e,t)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,n){e.isEmpty()&&t(38);let r=e;r._readOnly&&(r=Vr(e),r._selection=e._selection?e._selection.clone():null),re(this);const i=this._pendingEditorState,s=this._updateTags,o=void 0!==n?n.tag:null;null===i||i.isEmpty()||(null!=o&&s.add(o),Pr(this)),this._pendingEditorState=r,this._dirtyType=C,this._dirtyElements.set("root",!1),this._compositionKey=null,null!=o&&s.add(o),this._updating||Pr(this)}parseEditorState(e,t){return function(e,t,n){const r=Gr(),i=_r,s=mr,o=pr,l=t._dirtyElements,c=t._dirtyLeaves,a=t._cloneNotNeeded,u=t._dirtyType;t._dirtyElements=new Map,t._dirtyLeaves=new Set,t._cloneNotNeeded=new Set,t._dirtyType=0,_r=r,mr=!1,pr=t;try{const i=t._nodes;Ar(e.root,i),n&&n(),r._readOnly=!0}catch(e){e instanceof Error&&t._onError(e)}finally{t._dirtyElements=l,t._dirtyLeaves=c,t._cloneNotNeeded=a,t._dirtyType=u,_r=i,mr=s,pr=o}return r}("string"==typeof e?JSON.parse(e):e,this,t)}read(e){return Pr(this),this.getEditorState().read(e,{editor:this})}update(e,t){!function(e,t,n){e._updating?e._updates.push([t,n]):Rr(e,t,n)}(this,e,t)}focus(e,t={}){const n=this._rootElement;null!==n&&(n.setAttribute("autocapitalize","off"),Br(this,(()=>{const r=or(),i=Ei();null!==r?r.dirty=!0:0!==i.getChildrenSize()&&("rootStart"===t.defaultSelection?i.selectStart():i.selectEnd()),ts("focus"),ns((()=>{n.removeAttribute("autocapitalize"),e&&e()}))})),null===this._pendingEditorState&&n.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;null!==e&&e.blur();const t=gs(this._window);null!==t&&t.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,Ir("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}ri.version="0.25.0+prod.cjs";let ii=1;const si="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)};function oi(e){const t=document.activeElement;if(!ps(t))return!1;const n=t.nodeName;return jr(Ni(e))&&("INPUT"===n||"TEXTAREA"===n||"true"===t.contentEditable&&null==ui(t))}function li(e,t,n){const r=e.getRootElement();try{return null!==r&&r.contains(t)&&r.contains(n)&&null!==t&&!oi(t)&&ai(t)===e}catch(e){return!1}}function ci(e){return e instanceof ri}function ai(e){let t=e;for(;null!=t;){const e=ui(t);if(ci(e))return e;t=Zi(t)}return null}function ui(e){return e?e.__lexicalEditor:null}function fi(e){return e.isToken()||e.isSegmented()}function di(e){return ms(e)&&e.nodeType===_}function hi(e){return ms(e)&&e.nodeType===p}function gi(e){let t=e;for(;null!=t;){if(di(t))return t;t=t.firstChild}return null}function _i(e,t,n){const r=$[t];if(null!==n&&(e&r)==(n&r))return e;let i=e^r;return"subscript"===t?i&=~$.superscript:"superscript"===t?i&=~$.subscript:"lowercase"===t?(i&=~$.uppercase,i&=~$.capitalize):"uppercase"===t?(i&=~$.lowercase,i&=~$.capitalize):"capitalize"===t&&(i&=~$.lowercase,i&=~$.uppercase),i}function pi(e,t){if(null!=t)return void(e.__key=t);Tr(),vr();const n=br(),r=Nr(),i=""+ii++;r._nodeMap.set(i,e),Kr(e)?n._dirtyElements.set(i,!0):n._dirtyLeaves.add(i),n._cloneNotNeeded.add(i),n._dirtyType=x,e.__key=i}function mi(e){const t=e.getParent();if(null!==t){const n=e.getWritable(),r=t.getWritable(),i=e.getPreviousSibling(),s=e.getNextSibling();if(null===i)if(null!==s){const e=s.getWritable();r.__first=s.__key,e.__prev=null}else r.__first=null;else{const e=i.getWritable();if(null!==s){const t=s.getWritable();t.__prev=e.__key,e.__next=t.__key}else e.__next=null;n.__prev=null}if(null===s)if(null!==i){const e=i.getWritable();r.__last=i.__key,e.__next=null}else r.__last=null;else{const e=s.getWritable();if(null!==i){const t=i.getWritable();t.__next=e.__key,e.__prev=t.__key}else e.__prev=null;n.__next=null}r.__size--,n.__parent=null}}function yi(e){vr();const t=e.getLatest(),n=t.__parent,r=Nr(),i=br(),s=r._nodeMap,o=i._dirtyElements;null!==n&&function(e,t,n){let r=e;for(;null!==r;){if(n.has(r))return;const e=t.get(r);if(void 0===e)break;n.set(r,!1),r=e.__parent}}(n,s,o);const l=t.__key;i._dirtyType=x,Kr(e)?o.set(l,!0):i._dirtyLeaves.add(l)}function xi(e){Tr();const t=br(),n=t._compositionKey;if(e!==n){if(t._compositionKey=e,null!==n){const e=Si(n);null!==e&&e.getWritable()}if(null!==e){const t=Si(e);null!==t&&t.getWritable()}}}function Ci(){if(Sr())return null;return br()._compositionKey}function Si(e,t){const n=(t||Nr())._nodeMap.get(e);return void 0===n?null:n}function Ti(e,t){const n=vi(e,br());return void 0!==n?Si(n,t):null}function vi(e,t){return e[`__lexicalKey_${t._key}`]}function Ni(e,t){let n=e;for(;null!=n;){const e=Ti(n,t);if(null!==e)return e;n=Zi(n)}return null}function bi(e){const t=e._decorators,n=Object.assign({},t);return e._pendingDecorators=n,n}function ki(e){return e.read((()=>Ei().getTextContent()))}function Ei(){return Oi(Nr())}function Oi(e){return e._nodeMap.get("root")}function wi(e){Tr();const t=Nr();null!==e&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Mi(e){const t=br(),n=function(e,t){let n=e;for(;null!=n;){const e=vi(n,t);if(void 0!==e)return e;n=Zi(n)}return null}(e,t);if(null===n){return e===t.getRootElement()?Si("root"):null}return Si(n)}function Ai(e,t){return t?e.getTextContentSize():0}function Di(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function Pi(e){const t=[];let n=e;for(;null!==n;)t.push(n),n=n._parentEditor;return t}function Ii(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function Li(e){return di(e)?e.nodeValue:null}function Fi(e,t,n){const r=gs(ss(t));if(null===r)return;const i=r.anchorNode;let{anchorOffset:s,focusOffset:o}=r;if(null!==i){let t=Li(i);const r=Ni(i);if(null!==t&&In(r)){if(t===I&&n){const e=n.length;t=n,s=e,o=e}null!==t&&Ri(r,t,s,o,e)}}}function Ri(e,t,n,r,i){let s=e;if(s.isAttached()&&(i||!s.isDirty())){const o=s.isComposing();let a=t;(o||i)&&t[t.length-1]===I&&(a=t.slice(0,-1));const u=s.getTextContent();if(i||a!==u){if(""===a){if(xi(null),l||c||d)s.remove();else{const e=br();setTimeout((()=>{e.update((()=>{s.isAttached()&&s.remove()}))}),20)}return}const t=s.getParent(),i=lr(),u=s.getTextContentSize(),f=Ci(),h=s.getKey();if(s.isToken()||null!==f&&h===f&&!o||Jn(i)&&(null!==t&&!t.canInsertTextBefore()&&0===i.anchor.offset||i.anchor.key===e.__key&&0===i.anchor.offset&&!s.canInsertTextBefore()&&!o||i.focus.key===e.__key&&i.focus.offset===u&&!s.canInsertTextAfter()&&!o))return void s.markDirty();const g=or();if(!Jn(g)||null===n||null===r)return void s.setTextContent(a);if(g.setTextNodeRange(s,n,s,r),s.isSegmented()){const e=Pn(s.getTextContent());s.replace(e),s=e}s.setTextContent(a)}}}function Bi(e){return"ArrowLeft"===e}function zi(e){return"ArrowRight"===e}function Wi(e,t){return i?e:t}function $i(e){return"Enter"===e}function Ki(e){return"Backspace"===e}function Ui(e){return"Delete"===e}function Ji(e,t,n){return"a"===e.toLowerCase()&&Wi(t,n)}function ji(e,t){void 0===e.__lexicalClassNameCache&&(e.__lexicalClassNameCache={});const n=e.__lexicalClassNameCache,r=n[t];if(void 0!==r)return r;const i=e[t];if("string"==typeof i){const e=h(i);return n[t]=e,e}return i}function Hi(e,n,r,i,s){if(0===r.size)return;const o=i.__type,l=i.__key,c=n.get(o);void 0===c&&t(33,o);const a=c.klass;let u=e.get(a);void 0===u&&(u=new Map,e.set(a,u));const f=u.get(l),d="destroyed"===f&&"created"===s;(void 0===f||d)&&u.set(l,d?"updated":s)}function Yi(e,t,n){const r=e.getParent();let i=n,s=e;return null!==r&&(t&&0===n?(i=s.getIndexWithinParent(),s=r):t||n!==s.getChildrenSize()||(i=s.getIndexWithinParent()+1,s=r)),s.getChildAtIndex(t?i-1:i)}function Vi(e,t){const n=e.offset;if("element"===e.type){return Yi(e.getNode(),t,n)}{const r=e.getNode();if(t&&0===n||!t&&n===r.getTextContentSize()){const e=t?r.getPreviousSibling():r.getNextSibling();return null===e?Yi(r.getParentOrThrow(),t,r.getIndexWithinParent()+(t?0:1)):e}}return null}function Gi(e){const t=ss(e).event,n=t&&t.inputType;return"insertFromPaste"===n||"insertFromPasteAsQuotation"===n}function qi(e,t,n){return Lr(e,t,n)}function Xi(e){return!Yr(e)&&!e.isLastChild()&&!e.isInline()}function Qi(e,n){const r=e._keyToDOMMap.get(n);return void 0===r&&t(75,n),r}function Zi(e){const t=e.assignedSlot||e.parentElement;return ys(t)?t.host:t}function es(e){return hi(e)?e:ps(e)?e.ownerDocument:null}function ts(e){Tr();br()._updateTags.add(e)}function ns(e){Tr();br()._deferred.push(e)}function rs(e,t){let n=e.getParent();for(;null!==n;){if(n.is(t))return!0;n=n.getParent()}return!1}function is(e){const t=es(e);return t?t.defaultView:null}function ss(e){const n=e._window;return null===n&&t(78),n}function os(e){let t=e.getParentOrThrow();for(;null!==t;){if(ls(t))return t;t=t.getParentOrThrow()}return t}function ls(e){return Yr(e)||Kr(e)&&e.isShadowRoot()}function cs(e){const t=e.constructor.clone(e);return pi(t,null),t}function as(e){const n=br(),r=e.constructor.getType(),i=n._nodes.get(r);void 0===i&&t(200,e.constructor.name,r);const{replace:s,replaceWithKlass:o}=i;if(null!==s){const n=s(e),i=n.constructor;return null!==o?n instanceof o||t(201,o.name,o.getType(),i.name,i.getType(),e.constructor.name,r):n instanceof e.constructor&&i!==e.constructor||t(202,i.name,i.getType(),e.constructor.name,r),n.__key===e.__key&&t(203,e.constructor.name,r,i.name,i.getType()),n}return e}function us(e,n){!Yr(e.getParent())||Kr(n)||jr(n)||t(99)}function fs(e){const n=Si(e);return null===n&&t(63,e),n}function ds(e){return(jr(e)||Kr(e)&&!e.canBeEmpty())&&!e.isInline()}function hs(e,t,n){n.style.removeProperty("caret-color"),t._blockCursorElement=null;const r=e.parentElement;null!==r&&r.removeChild(e)}function gs(e){return n?(e||window).getSelection():null}function _s(e){const t=is(e);return t?t.getSelection():null}function ps(e){return ms(e)&&e.nodeType===g}function ms(e){return"object"==typeof e&&null!==e&&"nodeType"in e&&"number"==typeof e.nodeType}function ys(e){return ms(e)&&e.nodeType===m}function xs(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return null!==e.nodeName.match(t)}function Cs(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return null!==e.nodeName.match(t)}function Ss(e){if(jr(e)&&!e.isInline())return!0;if(!Kr(e)||ls(e))return!1;const t=e.getFirstChild(),n=null===t||pn(t)||In(t)||t.isInline();return!e.isInline()&&!1!==e.canBeEmpty()&&n}function Ts(e,t){let n=e;for(;null!==n&&null!==n.getParent()&&!t(n);)n=n.getParentOrThrow();return t(n)?n:null}const vs=new WeakMap,Ns=new Map;function bs(e){if(!e._readOnly&&e.isEmpty())return Ns;e._readOnly||t(192);let n=vs.get(e);return n||(n=function(e){const t=new Map;for(const[n,r]of e._nodeMap){const e=r.__type;let i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n,r)}return t}(e),vs.set(e,n)),n}function ks(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function Es(e,t){const n=(parseInt(e.style.paddingInlineStart,10)||0)/40;t.setIndent(n)}function Os(e){return!0===e.__lexicalUnmanaged}const ws={next:"previous",previous:"next"};class Ms{constructor(e){this.origin=e}[Symbol.iterator](){return eo({hasNext:Bs,initial:this.getAdjacentCaret(),map:e=>e,step:e=>e.getAdjacentCaret()})}getAdjacentCaret(){return Us(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return Us(this.origin,this.direction)}remove(){const e=this.getNodeAtCaret();return e&&e.remove(),this}replaceOrInsert(e,t){const n=this.getNodeAtCaret();return e.is(this.origin)||e.is(n)||(null===n?this.insert(e):n.replace(e,t)),this}splice(e,n,r="next"){const i=r===this.direction?n:Array.from(n).reverse();let s=this;const o=this.getParentAtCaret(),l=new Map;for(let t=s.getAdjacentCaret();null!==t&&l.size<e;t=t.getAdjacentCaret()){const e=t.origin.getWritable();l.set(e.getKey(),e)}for(const e of i){if(l.size>0){const n=s.getNodeAtCaret();if(n)if(l.delete(n.getKey()),l.delete(e.getKey()),n.is(e)||s.origin.is(e));else{const t=e.getParent();t&&t.is(o)&&e.remove(),n.replace(e)}else null===n&&t(263,Array.from(l).join(" "))}else s.insert(e);s=Us(e,this.direction)}for(const e of l.values())e.remove();return this}}class As extends Ms{type="child";getLatest(){const e=this.origin.getLatest();return e===this.origin?this:Ys(e,this.direction)}getParentCaret(e="root"){return Us(Is(this.getParentAtCaret(),e),this.direction)}getFlipped(){const e=Ps(this.direction);return Us(this.getNodeAtCaret(),e)||Ys(this.origin,e)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(e){return e instanceof As&&this.direction===e.direction&&this.origin.is(e.origin)}isSamePointCaret(e){return this.isSameNodeCaret(e)}}const Ds={root:Yr,shadowRoot:ls};function Ps(e){return ws[e]}function Is(e,t="root"){return Ds[t](e)?null:e}class Ls extends Ms{type="sibling";getLatest(){const e=this.origin.getLatest();return e===this.origin?this:Us(e,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return Kr(this.origin)?Ys(this.origin,this.direction):null}getParentCaret(e="root"){return Us(Is(this.getParentAtCaret(),e),this.direction)}getFlipped(){const e=Ps(this.direction);return Us(this.getNodeAtCaret(),e)||Ys(this.origin.getParentOrThrow(),e)}isSamePointCaret(e){return e instanceof Ls&&this.direction===e.direction&&this.origin.is(e.origin)}isSameNodeCaret(e){return(e instanceof Ls||e instanceof Fs)&&this.direction===e.direction&&this.origin.is(e.origin)}}class Fs extends Ms{type="text";constructor(e,t){super(e),this.offset=t}getLatest(){const e=this.origin.getLatest();return e===this.origin?this:Js(e,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(e="root"){return Us(Is(this.getParentAtCaret(),e),this.direction)}getFlipped(){return Js(this.origin,Ps(this.direction),this.offset)}isSamePointCaret(e){return e instanceof Fs&&this.direction===e.direction&&this.origin.is(e.origin)&&this.offset===e.offset}isSameNodeCaret(e){return(e instanceof Ls||e instanceof Fs)&&this.direction===e.direction&&this.origin.is(e.origin)}getSiblingCaret(){return Us(this.origin,this.direction)}}function Rs(e){return e instanceof Fs}function Bs(e){return e instanceof Ls}function zs(e){return e instanceof As}const Ws={next:class extends Fs{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Fs{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},$s={next:class extends Ls{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Ls{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},Ks={next:class extends As{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends As{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function Us(e,t){return e?new $s[t](e):null}function Js(e,t,n){return e?new Ws[t](e,js(e,n)):null}function js(e,n){const r=e.getTextContentSize(),i="next"===n?r:"previous"===n?0:n;return i>=0&&i<=r||t(264,String(n),String(r)),i}function Hs(e,t){return new Xs(e,t)}function Ys(e,t){return Kr(e)?new Ks[t](e):null}function Vs(e){return e&&e.getChildCaret()||e}function Gs(e){return e&&Vs(e.getAdjacentCaret())}class qs{type="node-caret-range";constructor(e,t,n){this.anchor=e,this.focus=t,this.direction=n}getLatest(){const e=this.anchor.getLatest(),t=this.focus.getLatest();return e===this.anchor&&t===this.focus?this:new qs(e,t,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const e=e=>{const t=this[e];return Rs(t)?function(e,t){const{direction:n,origin:r}=e,i=js(r,"focus"===t?Ps(n):n);return Hs(e,i-e.offset)}(t,e):null},t=e("anchor"),n=e("focus");if(t&&n){const{caret:e}=t,{caret:r}=n;if(e.isSameNodeCaret(r))return[Hs(e,r.offset-e.offset),null]}return[t,n]}iterNodeCarets(e="root"){const t=Rs(this.anchor)?this.anchor.getSiblingCaret():this.anchor,{focus:n}=this,r=Rs(n),i=t=>t.isSameNodeCaret(n)?null:Gs(t)||t.getParentCaret(e);return eo({hasNext:e=>null!==e&&!(r&&n.isSameNodeCaret(e)),initial:t.isSameNodeCaret(n)?null:i(t),map:e=>e,step:i})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class Xs{type="slice";constructor(e,t){this.caret=e,this.distance=t}getSliceIndices(){const{distance:e,caret:{offset:t}}=this,n=t+e;return n<t?[n,t]:[t,n]}getTextContent(){const[e,t]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(e,t)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:e,direction:t}}=this,[n,r]=this.getSliceIndices(),i=e.getTextContent();return Js(e.setTextContent(i.slice(0,n)+i.slice(r)),t,n)}}function Qs(e){return Zs(e,Us(Ei(),e.direction))}function Zs(e,n){return e.direction!==n.direction&&t(265),new qs(e,n,e.direction)}function eo(e){const{initial:t,hasNext:n,step:r,map:i}=e;let s=t;return{[Symbol.iterator](){return this},next(){if(!n(s))return{done:!0,value:void 0};const e={done:!1,value:i(s)};return s=r(s),e}}}function to(e,n){const{type:r,key:i,offset:s}=e,o=fs(e.key);return"text"===r?(In(o)||t(266,o.getType(),i),Js(o,n,s)):(Kr(o)||t(267,o.getType(),i),ho(o,e.offset,n))}function no(e,n){const{origin:r,direction:i}=n,s="next"===i;Rs(n)?e.set(r.getKey(),n.offset,"text"):Bs(n)?In(r)?e.set(r.getKey(),js(r,i),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(zs(n)&&Kr(r)||t(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function ro(e,t){no(e.anchor,t.anchor),no(e.focus,t.focus)}function io(e){const{anchor:t,focus:n}=e,r=n.isBefore(t)?"previous":"next";return Zs(to(t,r),to(n,r))}function so(e){const{direction:t,origin:n}=e,r=Us(n,Ps(t)).getNodeAtCaret();return r?Us(r,t):Ys(n.getParentOrThrow(),t)}function oo(e,t="root"){const n=[e];for(let r=zs(e)?e.getParentCaret(t):e.getSiblingCaret();null!==r;r=r.getParentCaret(t))n.push(so(r));return n}function lo(e){return!!e&&e.origin.isAttached()}function co(e,n="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",i="next";let s=n;const o=fo(e,i),l=oo(o.anchor,r),c=oo(o.focus.getFlipped(),r),a=new Set,u=[];for(const e of o.iterNodeCarets(r))if(zs(e))a.add(e.origin.getKey());else if(Bs(e)){const{origin:t}=e;Kr(t)&&!a.has(t.getKey())||u.push(t)}for(const e of u)e.remove();for(const e of o.getTextSlices()){if(!e)continue;const{origin:t}=e.caret,n=t.getTextContentSize(),r=so(Us(t,i)),o=t.getMode();if(Math.abs(e.distance)===n&&"removeEmptySlices"===s||"token"===o&&0!==e.distance)r.remove();else if(0!==e.distance){s="removeEmptySlices";let t=e.removeTextSlice();const n=e.caret.origin;if("segmented"===o){const e=t.origin,n=Pn(e.getTextContent()).setStyle(e.getStyle()).setFormat(e.getFormat());r.replaceOrInsert(n),t=Js(n,i,t.offset)}n.is(l[0].origin)&&(l[0]=t),n.is(c[0].origin)&&(c[0]=t.getFlipped())}}let f,d;for(const e of l)if(lo(e)){f=ao(e);break}for(const e of c)if(lo(e)){d=ao(e);break}const h=function(e,t,n){if(!e||!t)return null;const r=e.getParentAtCaret(),i=t.getParentAtCaret();if(!r||!i)return null;const s=r.getParents().reverse();s.push(r);const o=i.getParents().reverse();o.push(i);const l=Math.min(s.length,o.length);let c;for(c=0;c<l&&s[c]===o[c];c++);const a=(e,t)=>{let n;for(let r=c;r<e.length;r++){const i=e[r];if(ls(i))return;!n&&t(i)&&(n=i)}return n},u=a(s,Ss),f=u&&a(o,(e=>n.has(e.getKey())&&Ss(e)));return u&&f?[u,f]:null}(f,d,a);if(h){const[e,t]=h;Ys(e,"previous").splice(0,t.getChildren()),t.remove()}const g=[f,d,...l,...c].find(lo);if(g){const t=uo(ao(g),e.direction);return Zs(t,t)}t(269,JSON.stringify(l.map((e=>e.origin.__key))))}function ao(e){const t=function(e){let t=e;for(;zs(t);){const e=Gs(t);if(!zs(e))break;t=e}return t}(e.getLatest()),{direction:n}=t;if(In(t.origin))return Rs(t)?t:Js(t.origin,n,n);const r=t.getAdjacentCaret();return Bs(r)&&In(r.origin)?Js(r.origin,n,Ps(n)):t}function uo(e,t){return e.direction===t?e:e.getFlipped()}function fo(e,t){return e.direction===t?e:Zs(uo(e.focus,t),uo(e.anchor,t))}function ho(e,t,n){let r=Ys(e,"next");for(let e=0;e<t;e++){const e=r.getAdjacentCaret();if(null===e)break;r=e}return uo(r,n)}exports.$addUpdateTag=ts,exports.$applyNodeReplacement=as,exports.$caretFromPoint=to,exports.$caretRangeFromSelection=io,exports.$cloneWithProperties=ks,exports.$copyNode=cs,exports.$createLineBreakNode=_n,exports.$createNodeSelection=ir,exports.$createParagraphNode=ti,exports.$createPoint=Wn,exports.$createRangeSelection=rr,exports.$createRangeSelectionFromDom=function(e,t){return sr(null,e,t,null)},exports.$createTabNode=Rn,exports.$createTextNode=Pn,exports.$extendCaretToRange=Qs,exports.$getAdjacentChildCaret=Gs,exports.$getAdjacentNode=Vi,exports.$getAdjacentSiblingOrParentSiblingCaret=function(e,t="root"){let n=0,r=e,i=Gs(r);for(;null===i;){if(n--,i=r.getParentCaret(t),!i)return null;r=i,i=Gs(r)}return i&&[i,n]},exports.$getCaretInDirection=uo,exports.$getCaretRange=Zs,exports.$getCaretRangeInDirection=fo,exports.$getCharacterOffsets=Vn,exports.$getChildCaret=Ys,exports.$getChildCaretAtIndex=ho,exports.$getChildCaretOrSelf=Vs,exports.$getEditor=function(){return br()},exports.$getNearestNodeFromDOMNode=Ni,exports.$getNearestRootOrShadowRoot=os,exports.$getNodeByKey=Si,exports.$getNodeByKeyOrThrow=fs,exports.$getPreviousSelection=lr,exports.$getRoot=Ei,exports.$getSelection=or,exports.$getSiblingCaret=Us,exports.$getTextContent=function(){const e=or();return null===e?"":e.getTextContent()},exports.$getTextNodeOffset=js,exports.$getTextPointCaret=Js,exports.$getTextPointCaretSlice=Hs,exports.$hasAncestor=rs,exports.$hasUpdateTag=function(e){return br()._updateTags.has(e)},exports.$insertNodes=function(e){let t=or()||lr();null===t&&(t=Ei().selectEnd()),t.insertNodes(e)},exports.$isBlockElementNode=function(e){return Kr(e)&&!e.isInline()},exports.$isChildCaret=zs,exports.$isDecoratorNode=jr,exports.$isElementNode=Kr,exports.$isInlineElementOrDecoratorNode=function(e){return Kr(e)&&e.isInline()||jr(e)&&e.isInline()},exports.$isLeafNode=function(e){return In(e)||pn(e)||jr(e)},exports.$isLineBreakNode=pn,exports.$isNodeCaret=function(e){return e instanceof Ms},exports.$isNodeSelection=Hn,exports.$isParagraphNode=function(e){return e instanceof Zr},exports.$isRangeSelection=Jn,exports.$isRootNode=Yr,exports.$isRootOrShadowRoot=ls,exports.$isSiblingCaret=Bs,exports.$isTabNode=Bn,exports.$isTextNode=In,exports.$isTextPointCaret=Rs,exports.$isTextPointCaretSlice=function(e){return e instanceof Xs},exports.$isTokenOrSegmented=fi,exports.$nodesOfType=function(e){const t=e.getType(),n=Nr();if(n._readOnly){const e=bs(n).get(t);return e?Array.from(e.values()):[]}const r=n._nodeMap,i=[];for(const[,n]of r)n instanceof e&&n.__type===t&&n.isAttached()&&i.push(n);return i},exports.$normalizeCaret=ao,exports.$normalizeSelection__EXPERIMENTAL=ce,exports.$onUpdate=ns,exports.$parseSerializedNode=function(e){return Ar(e,br()._nodes)},exports.$removeTextFromCaretRange=co,exports.$rewindSiblingCaret=so,exports.$selectAll=function(e){const t=Ei();if(Jn(e)){const t=e.anchor,n=e.focus,r=t.getNode().getTopLevelElementOrThrow().getParentOrThrow();return t.set(r.getKey(),0,"element"),n.set(r.getKey(),r.getChildrenSize(),"element"),ce(e),e}{const e=t.select(0,t.getChildrenSize());return wi(ce(e)),e}},exports.$setCompositionKey=xi,exports.$setPointFromCaret=no,exports.$setSelection=wi,exports.$setSelectionFromCaretRange=function(e){const t=or(),n=Jn(t)?t:rr();return ro(n,e),wi(n),n},exports.$splitNode=function(e,n){let r=e.getChildAtIndex(n);null==r&&(r=e),ls(e)&&t(102);const i=e=>{const n=e.getParentOrThrow(),s=ls(n),o=e!==r||s?cs(e):e;if(s)return Kr(e)&&Kr(o)||t(133),e.insertAfter(o),[e,o,o];{const[t,r,s]=i(n),l=e.getNextSiblings();return s.append(o,...l),[t,r,o]}},[s,o]=i(r);return[s,o]},exports.$updateRangeSelectionFromCaretRange=ro,exports.ArtificialNode__DO_NOT_USE=Qr,exports.BLUR_COMMAND=Ft,exports.CAN_REDO_COMMAND=Pt,exports.CAN_UNDO_COMMAND=It,exports.CLEAR_EDITOR_COMMAND=At,exports.CLEAR_HISTORY_COMMAND=Dt,exports.CLICK_COMMAND=Ge,exports.COMMAND_PRIORITY_CRITICAL=4,exports.COMMAND_PRIORITY_EDITOR=0,exports.COMMAND_PRIORITY_HIGH=3,exports.COMMAND_PRIORITY_LOW=1,exports.COMMAND_PRIORITY_NORMAL=2,exports.CONTROLLED_TEXT_INSERTION_COMMAND=Ze,exports.COPY_COMMAND=Ot,exports.CUT_COMMAND=wt,exports.DELETE_CHARACTER_COMMAND=qe,exports.DELETE_LINE_COMMAND=rt,exports.DELETE_WORD_COMMAND=nt,exports.DRAGEND_COMMAND=Et,exports.DRAGOVER_COMMAND=kt,exports.DRAGSTART_COMMAND=bt,exports.DROP_COMMAND=vt,exports.DecoratorNode=Jr,exports.ElementNode=$r,exports.FOCUS_COMMAND=Lt,exports.FORMAT_ELEMENT_COMMAND=Nt,exports.FORMAT_TEXT_COMMAND=it,exports.INDENT_CONTENT_COMMAND=St,exports.INSERT_LINE_BREAK_COMMAND=Xe,exports.INSERT_PARAGRAPH_COMMAND=Qe,exports.INSERT_TAB_COMMAND=Ct,exports.INTERNAL_$isBlock=Ss,exports.IS_ALL_FORMATTING=E,exports.IS_BOLD=1,exports.IS_CODE=16,exports.IS_HIGHLIGHT=k,exports.IS_ITALIC=2,exports.IS_STRIKETHROUGH=N,exports.IS_SUBSCRIPT=32,exports.IS_SUPERSCRIPT=64,exports.IS_UNDERLINE=b,exports.KEY_ARROW_DOWN_COMMAND=ht,exports.KEY_ARROW_LEFT_COMMAND=ut,exports.KEY_ARROW_RIGHT_COMMAND=ct,exports.KEY_ARROW_UP_COMMAND=dt,exports.KEY_BACKSPACE_COMMAND=pt,exports.KEY_DELETE_COMMAND=yt,exports.KEY_DOWN_COMMAND=lt,exports.KEY_ENTER_COMMAND=gt,exports.KEY_ESCAPE_COMMAND=mt,exports.KEY_MODIFIER_COMMAND=Rt,exports.KEY_SPACE_COMMAND=_t,exports.KEY_TAB_COMMAND=xt,exports.LineBreakNode=hn,exports.MOVE_TO_END=at,exports.MOVE_TO_START=ft,exports.OUTDENT_CONTENT_COMMAND=Tt,exports.PASTE_COMMAND=et,exports.ParagraphNode=Zr,exports.REDO_COMMAND=ot,exports.REMOVE_TEXT_COMMAND=tt,exports.RootNode=Hr,exports.SELECTION_CHANGE_COMMAND=Ye,exports.SELECTION_INSERT_CLIPBOARD_NODES_COMMAND=Ve,exports.SELECT_ALL_COMMAND=Mt,exports.TEXT_TYPE_TO_FORMAT=$,exports.TabNode=Fn,exports.TextNode=Nn,exports.UNDO_COMMAND=st,exports.createCommand=He,exports.createEditor=function(e){const t=e||{},n=Er(),r=t.theme||{},i=void 0===e?n:t.parentEditor||null,s=t.disableEvents||!1,o=Gr(),l=t.namespace||(null!==i?i._config.namespace:Ii()),c=t.editorState,a=[Hr,Nn,hn,Fn,Zr,Qr,...t.nodes||[]],{onError:u,html:f}=t,d=void 0===t.editable||t.editable;let h;if(void 0===e&&null!==n)h=n._nodes;else{h=new Map;for(let e=0;e<a.length;e++){let t=a[e],n=null,r=null;if("function"!=typeof t){const e=t;t=e.replace,n=e.with,r=e.withKlass||null}const i=t.getType(),s=t.transform(),o=new Set;null!==s&&o.add(s),h.set(i,{exportDOM:f&&f.export?f.export.get(t):void 0,klass:t,replace:n,replaceWithKlass:r,transforms:o})}}const g=new ri(o,i,h,{disableEvents:s,namespace:l,theme:r},u||console.error,function(e,t){const n=new Map,r=new Set,i=e=>{Object.keys(e).forEach((t=>{let r=n.get(t);void 0===r&&(r=[],n.set(t,r)),r.push(e[t])}))};return e.forEach((e=>{const t=e.klass.importDOM;if(null==t||r.has(t))return;r.add(t);const n=t.call(e.klass);null!==n&&i(n)})),t&&i(t),n}(h,f?f.import:void 0),d);return void 0!==c&&(g._pendingEditorState=c,g._dirtyType=C),g},exports.flipDirection=Ps,exports.getDOMOwnerDocument=es,exports.getDOMSelection=gs,exports.getDOMSelectionFromTarget=_s,exports.getDOMTextNode=gi,exports.getEditorPropertyFromDOMNode=ui,exports.getNearestEditorFromDOMNode=ai,exports.isBlockDomNode=Cs,exports.isCurrentlyReadOnlyMode=Sr,exports.isDOMDocumentNode=hi,exports.isDOMNode=ms,exports.isDOMTextNode=di,exports.isDOMUnmanaged=Os,exports.isDocumentFragment=ys,exports.isHTMLAnchorElement=function(e){return ps(e)&&"A"===e.tagName},exports.isHTMLElement=ps,exports.isInlineDomNode=xs,exports.isLexicalEditor=ci,exports.isSelectionCapturedInDecoratorInput=oi,exports.isSelectionWithinEditor=li,exports.makeStepwiseIterator=eo,exports.resetRandomKey=function(){ii=1},exports.setDOMUnmanaged=function(e){e.__lexicalUnmanaged=!0},exports.setNodeIndentFromDOM=Es;
