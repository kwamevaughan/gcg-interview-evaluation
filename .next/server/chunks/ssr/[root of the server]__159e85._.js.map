{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///Users/Apple/Documents/Projects/Clients/GCC%20Internal%20Tools/gcg-interview-evaluation/lib/supabase.js"],"sourcesContent":["// lib/supabase.js\nimport { createClient } from '@supabase/supabase-js';\n\n// Client-side instance (uses anon key)\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_PROJECT_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n    console.error(\"Missing Supabase URL or Anon Key in environment variables.\");\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\n// Server-side instance (uses service key)\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY;\n\nif (!supabaseServiceKey) {\n    console.error(\"Missing Supabase Service Key in environment variables.\");\n}\n\nexport const supabaseAdmin = supabaseServiceKey\n    ? createClient(supabaseUrl, supabaseServiceKey)\n    : null;"],"names":[],"mappings":"AAAA,kBAAkB;;;;;AAClB;;AAEA,uCAAuC;AACvC,MAAM,cAAc,QAAQ,GAAG,CAAC,gCAAgC;AAChE,MAAM,kBAAkB,QAAQ,GAAG,CAAC,6BAA6B;AAEjE,IAAI,CAAC,eAAe,CAAC,iBAAiB;IAClC,QAAQ,KAAK,CAAC;AAClB;AAEO,MAAM,WAAW,CAAA,GAAA,iJAAA,CAAA,eAAY,AAAD,EAAE,aAAa;AAElD,0CAA0C;AAC1C,MAAM,qBAAqB,QAAQ,GAAG,CAAC,oBAAoB;AAE3D,IAAI,CAAC,oBAAoB;IACrB,QAAQ,KAAK,CAAC;AAClB;AAEO,MAAM,gBAAgB,qBACvB,CAAA,GAAA,iJAAA,CAAA,eAAY,AAAD,EAAE,aAAa,sBAC1B"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///Users/Apple/Documents/Projects/Clients/GCC%20Internal%20Tools/gcg-interview-evaluation/src/context/UserContext.js"],"sourcesContent":["import { createContext, useContext, useState, useEffect } from 'react';\nimport { supabase } from '/lib/supabase';\n\nconst UserContext = createContext();\n\nexport const useUser = () => {\n    const context = useContext(UserContext);\n    if (!context) {\n        throw new Error('useUser must be used within a UserProvider');\n    }\n    return context;\n};\n\nexport const UserProvider = ({ children }) => {\n    const [token, setToken] = useState(null);\n    const [user, setUser] = useState(null);\n    const [userFullName, setUserFullName] = useState('Guest');\n\n    useEffect(() => {\n        const storedSession = localStorage.getItem('supabase_session');\n        if (storedSession) {\n            try {\n                const session = JSON.parse(storedSession);\n                setToken(session.access_token); // Set the token\n                setUser(session.user); // Set user\n\n                // Optionally fetch user data like name if needed\n                if (session.user?.id) {\n                    const fetchUserData = async () => {\n                        const { data, error } = await supabase\n                            .from('client_users')\n                            .select('name')\n                            .eq('id', session.user.id)\n                            .single();\n\n                        if (error) {\n                            console.error('Error fetching user data:', error);\n                        } else {\n                            setUserFullName(data?.name || 'Guest');\n                        }\n                    };\n                    fetchUserData();\n                }\n            } catch (error) {\n                console.error('Error parsing session:', error);\n            }\n        }\n    }, []);\n\n    return (\n        <UserContext.Provider value={{ token, setToken, user, setUser, userFullName, setUserFullName }}>\n            {children}\n        </UserContext.Provider>\n    );\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEA,MAAM,4BAAc,CAAA,GAAA,mGAAA,CAAA,gBAAa,AAAD;AAEzB,MAAM,UAAU;IACnB,MAAM,UAAU,CAAA,GAAA,mGAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,CAAC,SAAS;QACV,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX;AAEO,MAAM,eAAe,CAAC,EAAE,QAAQ,EAAE;IACrC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,gBAAgB,aAAa,OAAO,CAAC;QAC3C,IAAI,eAAe;YACf,IAAI;gBACA,MAAM,UAAU,KAAK,KAAK,CAAC;gBAC3B,SAAS,QAAQ,YAAY,GAAG,gBAAgB;gBAChD,QAAQ,QAAQ,IAAI,GAAG,WAAW;gBAElC,iDAAiD;gBACjD,IAAI,QAAQ,IAAI,EAAE,IAAI;oBAClB,MAAM,gBAAgB;wBAClB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wGAAA,CAAA,WAAQ,CACjC,IAAI,CAAC,gBACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,QAAQ,IAAI,CAAC,EAAE,EACxB,MAAM;wBAEX,IAAI,OAAO;4BACP,QAAQ,KAAK,CAAC,6BAA6B;wBAC/C,OAAO;4BACH,gBAAgB,MAAM,QAAQ;wBAClC;oBACJ;oBACA;gBACJ;YACJ,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,0BAA0B;YAC5C;QACJ;IACJ,GAAG,EAAE;IAEL,qBACI,qKAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAO;YAAU;YAAM;YAAS;YAAc;QAAgB;kBACxF;;;;;;AAGb"}},
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///Users/Apple/Documents/Projects/Clients/GCC%20Internal%20Tools/gcg-interview-evaluation/src/pages/_app.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { UserProvider, useUser } from '../context/UserContext';\nimport SessionExpired from '../components/SessionExpired';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport '../styles/globals.css';\n\nfunction MyApp({ Component, pageProps }) {\n    const [mode, setMode] = useState('light');\n    const [isSessionExpired, setIsSessionExpired] = useState(false);\n    const router = useRouter();\n\n    // Check session on page load or when route changes\n    useEffect(() => {\n        const savedMode = localStorage.getItem('mode');\n        if (savedMode) {\n            setMode(savedMode);\n        } else {\n            const systemMode = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n            setMode(systemMode);\n        }\n\n        const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n        const handleChange = (e) => {\n            if (savedMode === 'system') {\n                setMode(e.matches ? 'dark' : 'light');\n            }\n        };\n        mediaQuery.addEventListener('change', handleChange);\n\n        return () => {\n            mediaQuery.removeEventListener('change', handleChange);\n        };\n    }, []);\n\n    return (\n        <UserProvider>\n            <UserComponent\n                mode={mode}\n                isSessionExpired={isSessionExpired}  // Pass isSessionExpired here\n                setIsSessionExpired={setIsSessionExpired}\n                router={router}\n                Component={Component}\n                pageProps={pageProps}\n            />\n            <ToastContainer position=\"top-right\" />\n        </UserProvider>\n    );\n}\n\nconst UserComponent = ({ mode, isSessionExpired, setIsSessionExpired, router, Component, pageProps }) => {\n    const { user, token, setToken, setUser } = useUser(); // Destructure setUser here\n\n    useEffect(() => {\n        const session = localStorage.getItem('supabase_session');\n\n        // Check if user is logged in\n        if (session) {\n            const parsedSession = JSON.parse(session);\n            setToken(parsedSession.access_token);  // Update context with new token\n            setUser(parsedSession.user);  // Set user in context\n        }\n    }, [setToken, setUser]);\n\n    useEffect(() => {\n        const excludedPaths = ['/', '/participate', '/client-login'];\n\n        // Only trigger session check if not on excluded paths\n        if (!excludedPaths.includes(router.pathname)) {\n            const session = localStorage.getItem('supabase_session');\n\n            if (!session || !JSON.parse(session).access_token) {\n                // Redirect to /participate if no session\n                setIsSessionExpired(true); // Optional: Set the session expired state to trigger the countdown\n                router.push('/participate');  // Redirect user to participate to log in\n            } else {\n                setIsSessionExpired(false); // Reset session expired state\n            }\n        }\n    }, [router.pathname, setIsSessionExpired]);\n\n    // Show session expired page if the session has expired and user is not on the /participate page\n    if (isSessionExpired && router.pathname !== '/participate') {\n        return <SessionExpired isSessionExpired={isSessionExpired} />;\n    }\n\n    return (\n        <div className={mode === 'dark' ? 'dark' : ''}>\n            <Component {...pageProps} mode={mode} />\n        </div>\n    );\n};\n\nexport default MyApp;\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AAIA,SAAS,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE;IACnC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IACzD,MAAM,SAAS,CAAA,GAAA,uHAAA,CAAA,YAAS,AAAD;IAEvB,mDAAmD;IACnD,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,YAAY,aAAa,OAAO,CAAC;QACvC,IAAI,WAAW;YACX,QAAQ;QACZ,OAAO;YACH,MAAM,aAAa,OAAO,UAAU,CAAC,gCAAgC,OAAO,GAAG,SAAS;YACxF,QAAQ;QACZ;QAEA,MAAM,aAAa,OAAO,UAAU,CAAC;QACrC,MAAM,eAAe,CAAC;YAClB,IAAI,cAAc,UAAU;gBACxB,QAAQ,EAAE,OAAO,GAAG,SAAS;YACjC;QACJ;QACA,WAAW,gBAAgB,CAAC,UAAU;QAEtC,OAAO;YACH,WAAW,mBAAmB,CAAC,UAAU;QAC7C;IACJ,GAAG,EAAE;IAEL,qBACI,qKAAC,sHAAA,CAAA,eAAY;;0BACT,qKAAC;gBACG,MAAM;gBACN,kBAAkB;gBAClB,qBAAqB;gBACrB,QAAQ;gBACR,WAAW;gBACX,WAAW;;;;;;0BAEf,qKAAC,kIAAA,CAAA,iBAAc;gBAAC,UAAS;;;;;;;;;;;;AAGrC;AAEA,MAAM,gBAAgB,CAAC,EAAE,IAAI,EAAE,gBAAgB,EAAE,mBAAmB,EAAE,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE;IAChG,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,sHAAA,CAAA,UAAO,AAAD,KAAK,2BAA2B;IAEjF,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,UAAU,aAAa,OAAO,CAAC;QAErC,6BAA6B;QAC7B,IAAI,SAAS;YACT,MAAM,gBAAgB,KAAK,KAAK,CAAC;YACjC,SAAS,cAAc,YAAY,GAAI,gCAAgC;YACvE,QAAQ,cAAc,IAAI,GAAI,sBAAsB;QACxD;IACJ,GAAG;QAAC;QAAU;KAAQ;IAEtB,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,gBAAgB;YAAC;YAAK;YAAgB;SAAgB;QAE5D,sDAAsD;QACtD,IAAI,CAAC,cAAc,QAAQ,CAAC,OAAO,QAAQ,GAAG;YAC1C,MAAM,UAAU,aAAa,OAAO,CAAC;YAErC,IAAI,CAAC,WAAW,CAAC,KAAK,KAAK,CAAC,SAAS,YAAY,EAAE;gBAC/C,yCAAyC;gBACzC,oBAAoB,OAAO,mEAAmE;gBAC9F,OAAO,IAAI,CAAC,iBAAkB,yCAAyC;YAC3E,OAAO;gBACH,oBAAoB,QAAQ,8BAA8B;YAC9D;QACJ;IACJ,GAAG;QAAC,OAAO,QAAQ;QAAE;KAAoB;IAEzC,gGAAgG;IAChG,IAAI,oBAAoB,OAAO,QAAQ,KAAK,gBAAgB;QACxD,qBAAO,qKAAC,4HAAA,CAAA,UAAc;YAAC,kBAAkB;;;;;;IAC7C;IAEA,qBACI,qKAAC;QAAI,WAAW,SAAS,SAAS,SAAS;kBACvC,cAAA,qKAAC;YAAW,GAAG,SAAS;YAAE,MAAM;;;;;;;;;;;AAG5C;uCAEe"}},
    {"offset": {"line": 339, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}